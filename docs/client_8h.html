<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SATP: Symmetric Authenticated Tunneling Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/SATP/SATP/client.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="satp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SATP: Symmetric Authenticated Tunneling Protocol<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A quantum secure symmetric pre-shared key tunneling protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('client_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">client.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The SATP client.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;satpcommon.h&quot;</code><br />
<code>#include &quot;<a class="el" href="satp_8h_source.html">satp.h</a>&quot;</code><br />
<code>#include &quot;socketclient.h&quot;</code><br />
</div>
<p><a href="client_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae64b4f5191521ff775757f69ca5b19d7" id="r_ae64b4f5191521ff775757f69ca5b19d7"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae64b4f5191521ff775757f69ca5b19d7">satp_client_send_error</a> (const qsc_socket *sock, <a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> error)</td></tr>
<tr class="memdesc:ae64b4f5191521ff775757f69ca5b19d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send an error code to the remote host.  <br /></td></tr>
<tr class="memitem:a925a8c49a96bd40728a07f8a7811b1a7" id="r_a925a8c49a96bd40728a07f8a7811b1a7"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API <a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a925a8c49a96bd40728a07f8a7811b1a7">satp_client_connect_ipv4</a> (<a class="el" href="structsatp__device__key.html">satp_device_key</a> *ckey, const qsc_ipinfo_ipv4_address *address, uint16_t port, void(*send_func)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *), void(*receive_callback)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *, const uint8_t *, size_t))</td></tr>
<tr class="memdesc:a925a8c49a96bd40728a07f8a7811b1a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish an IPv4 connection and perform the SATP key exchange.  <br /></td></tr>
<tr class="memitem:a20ec5a783f72e90b6e84996b5758c252" id="r_a20ec5a783f72e90b6e84996b5758c252"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API <a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20ec5a783f72e90b6e84996b5758c252">satp_client_connect_ipv6</a> (<a class="el" href="structsatp__device__key.html">satp_device_key</a> *ckey, const qsc_ipinfo_ipv6_address *address, uint16_t port, void(*send_func)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *), void(*receive_callback)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *, const uint8_t *, size_t))</td></tr>
<tr class="memdesc:a20ec5a783f72e90b6e84996b5758c252"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish an IPv6 connection and perform the SATP key exchange.  <br /></td></tr>
<tr class="memitem:ad912e10f05eefbcf9cf6ea0af5906a87" id="r_ad912e10f05eefbcf9cf6ea0af5906a87"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad912e10f05eefbcf9cf6ea0af5906a87">satp_client_connection_close</a> (<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *cns, <a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> error)</td></tr>
<tr class="memdesc:ad912e10f05eefbcf9cf6ea0af5906a87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the remote session and dispose of client resources.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The SATP client. </p>
<p>This header defines the client-side functions and state structures for the Symmetric Key Distribution Protocol (SATP). The SATP client is responsible for initiating secure key exchange sessions with an SATP server, managing encryption and decryption of messages, and handling key ratcheting to provide forward secrecy. It supports network connections over both IPv4 and IPv6.</p>
<p>The key exchange process in SATP involves several stages, including connection, exchange, establish, and ratchet operations. In each phase, ephemeral keys are derived from pre-shared keys so that even if a device's embedded key is compromised, past communications remain secure.</p>
<dl class="section note"><dt>Note</dt><dd>All functions and structures defined in this header are part of the internal client implementation. </dd></dl>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a925a8c49a96bd40728a07f8a7811b1a7" name="a925a8c49a96bd40728a07f8a7811b1a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a925a8c49a96bd40728a07f8a7811b1a7">&#9670;&#160;</a></span>satp_client_connect_ipv4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API <a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> satp_client_connect_ipv4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__device__key.html">satp_device_key</a> *</td>          <td class="paramname"><span class="paramname"><em>ckey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const qsc_ipinfo_ipv4_address *</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>send_func&#160;</em></span>)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>receive_callback&#160;</em></span>)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *, const uint8_t *, size_t)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish an IPv4 connection and perform the SATP key exchange. </p>
<p>This function connects to an SATP server over IPv4 and performs the key exchange protocol. It updates the client state with session parameters including cipher states and sequence numbers, and returns the connected socket via the provided socket pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ckey</td><td>A pointer to the key state structure. </td></tr>
    <tr><td class="paramname">address</td><td>A pointer to the server's IPv4 network address. </td></tr>
    <tr><td class="paramname">port</td><td>The server's port number. </td></tr>
    <tr><td class="paramname">send_func</td><td>A pointer to the send callback function responsible for transmitting messages. </td></tr>
    <tr><td class="paramname">receive_callback</td><td>A pointer to the receive callback function used to process incoming data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a" title="The SATP error values. This enumeration defines the error codes returned by SATP functions.">satp_errors</a></code> indicating the success or failure of the connection and key exchange process. </dd></dl>

</div>
</div>
<a id="a20ec5a783f72e90b6e84996b5758c252" name="a20ec5a783f72e90b6e84996b5758c252"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ec5a783f72e90b6e84996b5758c252">&#9670;&#160;</a></span>satp_client_connect_ipv6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API <a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> satp_client_connect_ipv6 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__device__key.html">satp_device_key</a> *</td>          <td class="paramname"><span class="paramname"><em>ckey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const qsc_ipinfo_ipv6_address *</td>          <td class="paramname"><span class="paramname"><em>address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>port</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>send_func&#160;</em></span>)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *), </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*</td>          <td class="paramname"><span class="paramname"><em>receive_callback&#160;</em></span>)(<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *, const uint8_t *, size_t)&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish an IPv6 connection and perform the SATP key exchange. </p>
<p>This function connects to an SATP server over IPv4 and performs the key exchange protocol. It updates the client state with session parameters including cipher states and sequence numbers, and returns the connected socket via the provided socket pointer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ckey</td><td>A pointer to the key state structure. </td></tr>
    <tr><td class="paramname">address</td><td>A pointer to the server's IPv6 network address. </td></tr>
    <tr><td class="paramname">port</td><td>The server's port number. </td></tr>
    <tr><td class="paramname">send_func</td><td>A pointer to the send callback function responsible for transmitting messages. </td></tr>
    <tr><td class="paramname">receive_callback</td><td>A pointer to the receive callback function used to process incoming data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a" title="The SATP error values. This enumeration defines the error codes returned by SATP functions.">satp_errors</a></code> indicating the success or failure of the connection and key exchange process. </dd></dl>

</div>
</div>
<a id="ad912e10f05eefbcf9cf6ea0af5906a87" name="ad912e10f05eefbcf9cf6ea0af5906a87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad912e10f05eefbcf9cf6ea0af5906a87">&#9670;&#160;</a></span>satp_client_connection_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_client_connection_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the remote session and dispose of client resources. </p>
<p>This function closes the SATP client session by sending an error notification (if necessary) to the remote host, and then disposing of the client state and releasing the associated socket resources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cns</td><td>A pointer to the connection state structure. </td></tr>
    <tr><td class="paramname">error</td><td>The SATP error code indicating the reason for closing the session. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae64b4f5191521ff775757f69ca5b19d7" name="ae64b4f5191521ff775757f69ca5b19d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae64b4f5191521ff775757f69ca5b19d7">&#9670;&#160;</a></span>satp_client_send_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_client_send_error </td>
          <td>(</td>
          <td class="paramtype">const qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="satp_8h.html#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send an error code to the remote host. </p>
<p>This function transmits an SATP error code over the specified socket, thereby informing the remote host of an error condition encountered during communication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>A pointer to the initialized socket structure. </td></tr>
    <tr><td class="paramname">error</td><td>The SATP error code to be sent. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_e669f2dbe370c85fafb6565895d91f2e.html">SATP</a></li><li class="navelem"><a href="client_8h.html">client.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
