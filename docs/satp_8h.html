<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SATP: Symmetric Authenticated Tunneling Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/SATP/SATP/satp.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="satp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SATP: Symmetric Authenticated Tunneling Protocol<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A quantum secure symmetric pre-shared key tunneling protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('satp_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">satp.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>SATP support header Common defined parameters and functions of the SATP client and server implementations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;satpcommon.h&quot;</code><br />
<code>#include &quot;sha3.h&quot;</code><br />
<code>#include &quot;socket.h&quot;</code><br />
<code>#include &quot;socketclient.h&quot;</code><br />
<code>#include &quot;rcs.h&quot;</code><br />
</div>
<p><a href="satp_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:satp_5Fconnection_5Fstate" id="r_satp_5Fconnection_5Fstate"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP socket connection state structure.  <a href="structsatp__connection__state.html#details">More...</a><br /></td></tr>
<tr class="memitem:satp_5Fdevice_5Fkey" id="r_satp_5Fdevice_5Fkey"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsatp__device__key.html">satp_device_key</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP device key structure. This structure represents the SATP device key, which is derived from the server key. It includes the device key identity, device derivation key, and an expiration time.  <a href="structsatp__device__key.html#details">More...</a><br /></td></tr>
<tr class="memitem:satp_5Fmaster_5Fkey" id="r_satp_5Fmaster_5Fkey"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsatp__master__key.html">satp_master_key</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP master key structure. This structure holds the SATP master key information, including the key identity, the master derivation key, and the expiration time. The master key is used as the root from which branch keys are derived.  <a href="structsatp__master__key.html#details">More...</a><br /></td></tr>
<tr class="memitem:satp_5Fserver_5Fkey" id="r_satp_5Fserver_5Fkey"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsatp__server__key.html">satp_server_key</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP server key structure. This structure represents the SATP server key, which is derived from the master key. It contains the server's key identity, server derivation key, and expiration time.  <a href="structsatp__server__key.html#details">More...</a><br /></td></tr>
<tr class="memitem:qsmp_5Fkeep_5Falive_5Fstate" id="r_qsmp_5Fkeep_5Falive_5Fstate"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqsmp__keep__alive__state.html">qsmp_keep_alive_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP keep alive state structure. This structure tracks the state of keep alive messages within SATP. It includes the epoch time when the last keep alive message was sent, a packet sequence counter, and a flag indicating whether a response has been received.  <a href="structqsmp__keep__alive__state.html#details">More...</a><br /></td></tr>
<tr class="memitem:satp_5Fnetwork_5Fpacket" id="r_satp_5Fnetwork_5Fpacket"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP network packet structure. This structure defines the format of a SATP network packet. It includes a packet flag, the message length, a sequence number, a UTC timestamp for packet creation, and a pointer to the message data.  <a href="structsatp__network__packet.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3781926192a613e59225b259cef1f28c" id="r_a3781926192a613e59225b259cef1f28c"><td class="memItemLeft" align="right" valign="top"><a id="a3781926192a613e59225b259cef1f28c" name="a3781926192a613e59225b259cef1f28c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_USE_RCS_ENCRYPTION</b></td></tr>
<tr class="memdesc:a3781926192a613e59225b259cef1f28c"><td class="mdescLeft">&#160;</td><td class="mdescRight">If the RCS encryption option is chosen SATP uses the more modern RCS stream cipher with KMAC/QMAC authentication. The default symmetric cipher/authenticator is AES-256/GCM (GMAC Counter Mode) NIST standardized per SP800-38a. <br /></td></tr>
<tr class="memitem:a457c27c4a5da2abedd6db378a2e4355a" id="r_a457c27c4a5da2abedd6db378a2e4355a"><td class="memItemLeft" align="right" valign="top"><a id="a457c27c4a5da2abedd6db378a2e4355a" name="a457c27c4a5da2abedd6db378a2e4355a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>satp_cipher_state</b>&#160;&#160;&#160;qsc_rcs_state</td></tr>
<tr class="memitem:adb450d725f0e9a93d017c740f5d3def7" id="r_adb450d725f0e9a93d017c740f5d3def7"><td class="memItemLeft" align="right" valign="top"><a id="adb450d725f0e9a93d017c740f5d3def7" name="adb450d725f0e9a93d017c740f5d3def7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>satp_cipher_dispose</b>&#160;&#160;&#160;qsc_rcs_dispose</td></tr>
<tr class="memitem:a52720e84105a014c432f25a138ce48c8" id="r_a52720e84105a014c432f25a138ce48c8"><td class="memItemLeft" align="right" valign="top"><a id="a52720e84105a014c432f25a138ce48c8" name="a52720e84105a014c432f25a138ce48c8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>satp_cipher_initialize</b>&#160;&#160;&#160;qsc_rcs_initialize</td></tr>
<tr class="memitem:ae5a79afc10899d0deac95fec66966e55" id="r_ae5a79afc10899d0deac95fec66966e55"><td class="memItemLeft" align="right" valign="top"><a id="ae5a79afc10899d0deac95fec66966e55" name="ae5a79afc10899d0deac95fec66966e55"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>satp_cipher_keyparams</b>&#160;&#160;&#160;qsc_rcs_keyparams</td></tr>
<tr class="memitem:afc110de1909f1359f029c2a3843003b2" id="r_afc110de1909f1359f029c2a3843003b2"><td class="memItemLeft" align="right" valign="top"><a id="afc110de1909f1359f029c2a3843003b2" name="afc110de1909f1359f029c2a3843003b2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>satp_cipher_set_associated</b>&#160;&#160;&#160;qsc_rcs_set_associated</td></tr>
<tr class="memitem:a2678bd82012a6a293436e27c98de4836" id="r_a2678bd82012a6a293436e27c98de4836"><td class="memItemLeft" align="right" valign="top"><a id="a2678bd82012a6a293436e27c98de4836" name="a2678bd82012a6a293436e27c98de4836"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>satp_cipher_transform</b>&#160;&#160;&#160;qsc_rcs_transform</td></tr>
<tr class="memitem:a20277709f9afb30843128daeb632c580" id="r_a20277709f9afb30843128daeb632c580"><td class="memItemLeft" align="right" valign="top"><a id="a20277709f9afb30843128daeb632c580" name="a20277709f9afb30843128daeb632c580"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_CLIENT_PASSWORD_MAX</b>&#160;&#160;&#160;256U</td></tr>
<tr class="memdesc:a20277709f9afb30843128daeb632c580"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client passphrase maximum string length. <br /></td></tr>
<tr class="memitem:af58a2c206f8952d8013414a41c2b3ce4" id="r_af58a2c206f8952d8013414a41c2b3ce4"><td class="memItemLeft" align="right" valign="top"><a id="af58a2c206f8952d8013414a41c2b3ce4" name="af58a2c206f8952d8013414a41c2b3ce4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_CLIENT_USERNAME_MAX</b>&#160;&#160;&#160;256U</td></tr>
<tr class="memdesc:af58a2c206f8952d8013414a41c2b3ce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client username maximum string length. <br /></td></tr>
<tr class="memitem:a8ef1b32919e3f230c9a4849245fdd2da" id="r_a8ef1b32919e3f230c9a4849245fdd2da"><td class="memItemLeft" align="right" valign="top"><a id="a8ef1b32919e3f230c9a4849245fdd2da" name="a8ef1b32919e3f230c9a4849245fdd2da"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_CONNECTIONS_INIT</b>&#160;&#160;&#160;1000U</td></tr>
<tr class="memdesc:a8ef1b32919e3f230c9a4849245fdd2da"><td class="mdescLeft">&#160;</td><td class="mdescRight">The intitial SATP connections queue size. <br /></td></tr>
<tr class="memitem:a41bde198c9b551c0cd16b32297617153" id="r_a41bde198c9b551c0cd16b32297617153"><td class="memItemLeft" align="right" valign="top"><a id="a41bde198c9b551c0cd16b32297617153" name="a41bde198c9b551c0cd16b32297617153"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_CONNECTIONS_MAX</b>&#160;&#160;&#160;50000U</td></tr>
<tr class="memdesc:a41bde198c9b551c0cd16b32297617153"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of connections. <br /></td></tr>
<tr class="memitem:afea8720f234f62f4a19f6d951b54d58d" id="r_afea8720f234f62f4a19f6d951b54d58d"><td class="memItemLeft" align="right" valign="top"><a id="afea8720f234f62f4a19f6d951b54d58d" name="afea8720f234f62f4a19f6d951b54d58d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_CONFIG_SIZE</b>&#160;&#160;&#160;25U</td></tr>
<tr class="memdesc:afea8720f234f62f4a19f6d951b54d58d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size of the protocol configuration string. <br /></td></tr>
<tr class="memitem:a158f1fc90b6636c22f098d9e97f996f4" id="r_a158f1fc90b6636c22f098d9e97f996f4"><td class="memItemLeft" align="right" valign="top"><a id="a158f1fc90b6636c22f098d9e97f996f4" name="a158f1fc90b6636c22f098d9e97f996f4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_ERROR_SIZE</b>&#160;&#160;&#160;1U</td></tr>
<tr class="memdesc:a158f1fc90b6636c22f098d9e97f996f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size of a system error message. <br /></td></tr>
<tr class="memitem:a7f6579e0efba42857a914de8b486840d" id="r_a7f6579e0efba42857a914de8b486840d"><td class="memItemLeft" align="right" valign="top"><a id="a7f6579e0efba42857a914de8b486840d" name="a7f6579e0efba42857a914de8b486840d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_EXPIRATION_SIZE</b>&#160;&#160;&#160;8U</td></tr>
<tr class="memdesc:a7f6579e0efba42857a914de8b486840d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size (in bytes) of the expiration field. <br /></td></tr>
<tr class="memitem:a2ccf5e1b5e2c43f7295979b7828377e6" id="r_a2ccf5e1b5e2c43f7295979b7828377e6"><td class="memItemLeft" align="right" valign="top"><a id="a2ccf5e1b5e2c43f7295979b7828377e6" name="a2ccf5e1b5e2c43f7295979b7828377e6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_HASH_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:a2ccf5e1b5e2c43f7295979b7828377e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP hash size in bytes. <br /></td></tr>
<tr class="memitem:a2ffb5a23ee8a36fcec7cf65d6a3e2e15" id="r_a2ffb5a23ee8a36fcec7cf65d6a3e2e15"><td class="memItemLeft" align="right" valign="top"><a id="a2ffb5a23ee8a36fcec7cf65d6a3e2e15" name="a2ffb5a23ee8a36fcec7cf65d6a3e2e15"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_HEADER_SIZE</b>&#160;&#160;&#160;21U</td></tr>
<tr class="memdesc:a2ffb5a23ee8a36fcec7cf65d6a3e2e15"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP packet header size in bytes. <br /></td></tr>
<tr class="memitem:afd1613bbf06416e196a4c524ac476c82" id="r_afd1613bbf06416e196a4c524ac476c82"><td class="memItemLeft" align="right" valign="top"><a id="afd1613bbf06416e196a4c524ac476c82" name="afd1613bbf06416e196a4c524ac476c82"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEEPALIVE_MESSAGE</b>&#160;&#160;&#160;8U</td></tr>
<tr class="memdesc:afd1613bbf06416e196a4c524ac476c82"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size (in bytes) of the keep alive integer message. <br /></td></tr>
<tr class="memitem:a12dbd80e799088d3020722cc833934fd" id="r_a12dbd80e799088d3020722cc833934fd"><td class="memItemLeft" align="right" valign="top"><a id="a12dbd80e799088d3020722cc833934fd" name="a12dbd80e799088d3020722cc833934fd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEEPALIVE_STRING</b>&#160;&#160;&#160;20U</td></tr>
<tr class="memdesc:a12dbd80e799088d3020722cc833934fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The keep alive string size in bytes. <br /></td></tr>
<tr class="memitem:ab0db46c9761c14886afce69e1fccf042" id="r_ab0db46c9761c14886afce69e1fccf042"><td class="memItemLeft" align="right" valign="top"><a id="ab0db46c9761c14886afce69e1fccf042" name="ab0db46c9761c14886afce69e1fccf042"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEEPALIVE_TIMEOUT</b>&#160;&#160;&#160;(300U * 1000U)</td></tr>
<tr class="memdesc:ab0db46c9761c14886afce69e1fccf042"><td class="mdescLeft">&#160;</td><td class="mdescRight">The keep alive timeout in milliseconds (5 minutes). <br /></td></tr>
<tr class="memitem:a7f8c8dfaa8d1d7099820c1ccef5b2672" id="r_a7f8c8dfaa8d1d7099820c1ccef5b2672"><td class="memItemLeft" align="right" valign="top"><a id="a7f8c8dfaa8d1d7099820c1ccef5b2672" name="a7f8c8dfaa8d1d7099820c1ccef5b2672"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEY_TREE_COUNT</b>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:a7f8c8dfaa8d1d7099820c1ccef5b2672"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP key tree count. <br /></td></tr>
<tr class="memitem:a6b855b04abe2e1fe4eea111afeb78b16" id="r_a6b855b04abe2e1fe4eea111afeb78b16"><td class="memItemLeft" align="right" valign="top"><a id="a6b855b04abe2e1fe4eea111afeb78b16" name="a6b855b04abe2e1fe4eea111afeb78b16"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MACTAG_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:a6b855b04abe2e1fe4eea111afeb78b16"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP configuration string for 256-bit security. <br /></td></tr>
<tr class="memitem:a312ddf5a9842749b119212e88c4202be" id="r_a312ddf5a9842749b119212e88c4202be"><td class="memItemLeft" align="right" valign="top"><a id="a312ddf5a9842749b119212e88c4202be" name="a312ddf5a9842749b119212e88c4202be"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MESSAGE_SIZE</b>&#160;&#160;&#160;1024U</td></tr>
<tr class="memdesc:a312ddf5a9842749b119212e88c4202be"><td class="mdescLeft">&#160;</td><td class="mdescRight">The message size (in bytes) used during a communications session. <br /></td></tr>
<tr class="memitem:a0a1241ef7137bd33fc9f39a00adb35bd" id="r_a0a1241ef7137bd33fc9f39a00adb35bd"><td class="memItemLeft" align="right" valign="top"><a id="a0a1241ef7137bd33fc9f39a00adb35bd" name="a0a1241ef7137bd33fc9f39a00adb35bd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MESSAGE_MAX</b>&#160;&#160;&#160;(<a class="el" href="#a312ddf5a9842749b119212e88c4202be">SATP_MESSAGE_SIZE</a> + <a class="el" href="#a2ffb5a23ee8a36fcec7cf65d6a3e2e15">SATP_HEADER_SIZE</a>)</td></tr>
<tr class="memdesc:a0a1241ef7137bd33fc9f39a00adb35bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum message size in bytes (may exceed MTU). <br /></td></tr>
<tr class="memitem:addc804fd519c7e81d7f66dbcb7907b8c" id="r_addc804fd519c7e81d7f66dbcb7907b8c"><td class="memItemLeft" align="right" valign="top"><a id="addc804fd519c7e81d7f66dbcb7907b8c" name="addc804fd519c7e81d7f66dbcb7907b8c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_CONNECTION_MTU</b>&#160;&#160;&#160;1500U</td></tr>
<tr class="memdesc:addc804fd519c7e81d7f66dbcb7907b8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP packet buffer size. <br /></td></tr>
<tr class="memitem:aa87e9423e91b8fd1a0b98bac45755a87" id="r_aa87e9423e91b8fd1a0b98bac45755a87"><td class="memItemLeft" align="right" valign="top"><a id="aa87e9423e91b8fd1a0b98bac45755a87" name="aa87e9423e91b8fd1a0b98bac45755a87"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_NONCE_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:aa87e9423e91b8fd1a0b98bac45755a87"><td class="mdescLeft">&#160;</td><td class="mdescRight">The nonce size in bytes. <br /></td></tr>
<tr class="memitem:abd6e04bbc39dffe4395782d752919e40" id="r_abd6e04bbc39dffe4395782d752919e40"><td class="memItemLeft" align="right" valign="top"><a id="abd6e04bbc39dffe4395782d752919e40" name="abd6e04bbc39dffe4395782d752919e40"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SALT_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:abd6e04bbc39dffe4395782d752919e40"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP salt size in bytes. <br /></td></tr>
<tr class="memitem:aad5afd72918b2d0dc3f7078fa583c8fb" id="r_aad5afd72918b2d0dc3f7078fa583c8fb"><td class="memItemLeft" align="right" valign="top"><a id="aad5afd72918b2d0dc3f7078fa583c8fb" name="aad5afd72918b2d0dc3f7078fa583c8fb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SERVER_PORT</b>&#160;&#160;&#160;2701U</td></tr>
<tr class="memdesc:aad5afd72918b2d0dc3f7078fa583c8fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default SATP server port number. <br /></td></tr>
<tr class="memitem:a7abe2545d495b62d9157c24dbfaeceea" id="r_a7abe2545d495b62d9157c24dbfaeceea"><td class="memItemLeft" align="right" valign="top"><a id="a7abe2545d495b62d9157c24dbfaeceea" name="a7abe2545d495b62d9157c24dbfaeceea"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SEQUENCE_TERMINATOR</b>&#160;&#160;&#160;0xFFFFFFFFUL</td></tr>
<tr class="memdesc:a7abe2545d495b62d9157c24dbfaeceea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sequence number of a packet that closes a connection. <br /></td></tr>
<tr class="memitem:acfb75d3ded818ff81dd13465dcdd7976" id="r_acfb75d3ded818ff81dd13465dcdd7976"><td class="memItemLeft" align="right" valign="top"><a id="acfb75d3ded818ff81dd13465dcdd7976" name="acfb75d3ded818ff81dd13465dcdd7976"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEY_DURATION_DAYS</b>&#160;&#160;&#160;365U</td></tr>
<tr class="memdesc:acfb75d3ded818ff81dd13465dcdd7976"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of days a key remains valid. <br /></td></tr>
<tr class="memitem:ab85d8ae0229ca75b7de3d1e3f149efd2" id="r_ab85d8ae0229ca75b7de3d1e3f149efd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab85d8ae0229ca75b7de3d1e3f149efd2">SATP_PACKET_TIME_THRESHOLD</a>&#160;&#160;&#160;60U</td></tr>
<tr class="memdesc:ab85d8ae0229ca75b7de3d1e3f149efd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of seconds a packet is considered valid.  <br /></td></tr>
<tr class="memitem:a944a93b35a802789b7f05b069de1e68b" id="r_a944a93b35a802789b7f05b069de1e68b"><td class="memItemLeft" align="right" valign="top"><a id="a944a93b35a802789b7f05b069de1e68b" name="a944a93b35a802789b7f05b069de1e68b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEY_DURATION_SECONDS</b>&#160;&#160;&#160;(<a class="el" href="#acfb75d3ded818ff81dd13465dcdd7976">SATP_KEY_DURATION_DAYS</a> * 24U * 60U * 60U)</td></tr>
<tr class="memdesc:a944a93b35a802789b7f05b069de1e68b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of seconds a key remains valid. <br /></td></tr>
<tr class="memitem:af18b2ae7978d8481be0d83a0f83dde9d" id="r_af18b2ae7978d8481be0d83a0f83dde9d"><td class="memItemLeft" align="right" valign="top"><a id="af18b2ae7978d8481be0d83a0f83dde9d" name="af18b2ae7978d8481be0d83a0f83dde9d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_BRANCH_ID_SIZE</b>&#160;&#160;&#160;2U</td></tr>
<tr class="memdesc:af18b2ae7978d8481be0d83a0f83dde9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Branch ID size in bytes. <br /></td></tr>
<tr class="memitem:abc4ba90f4d749d5ebb8021871b677a43" id="r_abc4ba90f4d749d5ebb8021871b677a43"><td class="memItemLeft" align="right" valign="top"><a id="abc4ba90f4d749d5ebb8021871b677a43" name="abc4ba90f4d749d5ebb8021871b677a43"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_DOMAIN_ID_SIZE</b>&#160;&#160;&#160;2U</td></tr>
<tr class="memdesc:abc4ba90f4d749d5ebb8021871b677a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Domain (Master) ID size in bytes. <br /></td></tr>
<tr class="memitem:ababa3b4f9709484fb79448c6541308de" id="r_ababa3b4f9709484fb79448c6541308de"><td class="memItemLeft" align="right" valign="top"><a id="ababa3b4f9709484fb79448c6541308de" name="ababa3b4f9709484fb79448c6541308de"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_DEVICE_ID_SIZE</b>&#160;&#160;&#160;4U</td></tr>
<tr class="memdesc:ababa3b4f9709484fb79448c6541308de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Device ID size in bytes. <br /></td></tr>
<tr class="memitem:a9880cc763010b2952af9539d078195a0" id="r_a9880cc763010b2952af9539d078195a0"><td class="memItemLeft" align="right" valign="top"><a id="a9880cc763010b2952af9539d078195a0" name="a9880cc763010b2952af9539d078195a0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_EPOCH_SIZE</b>&#160;&#160;&#160;2U</td></tr>
<tr class="memdesc:a9880cc763010b2952af9539d078195a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Epoch class size in bytes. <br /></td></tr>
<tr class="memitem:afebb1e80c8b1c6b8c02734c62c03aa7e" id="r_afebb1e80c8b1c6b8c02734c62c03aa7e"><td class="memItemLeft" align="right" valign="top"><a id="afebb1e80c8b1c6b8c02734c62c03aa7e" name="afebb1e80c8b1c6b8c02734c62c03aa7e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_ERROR_MESSAGE_SIZE</b>&#160;&#160;&#160;1U</td></tr>
<tr class="memdesc:afebb1e80c8b1c6b8c02734c62c03aa7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The packet error message size. <br /></td></tr>
<tr class="memitem:a982ab31e19241f4e094aad24f13221ce" id="r_a982ab31e19241f4e094aad24f13221ce"><td class="memItemLeft" align="right" valign="top"><a id="a982ab31e19241f4e094aad24f13221ce" name="a982ab31e19241f4e094aad24f13221ce"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_ERROR_SEQUENCE</b>&#160;&#160;&#160;0xFF00000000000000ULL</td></tr>
<tr class="memdesc:a982ab31e19241f4e094aad24f13221ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">The packet error sequence number. <br /></td></tr>
<tr class="memitem:a34327b08780546d7b10b3f56970a74dd" id="r_a34327b08780546d7b10b3f56970a74dd"><td class="memItemLeft" align="right" valign="top"><a id="a34327b08780546d7b10b3f56970a74dd" name="a34327b08780546d7b10b3f56970a74dd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_FLAG_SIZE</b>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a34327b08780546d7b10b3f56970a74dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The packet flag size. <br /></td></tr>
<tr class="memitem:a3f5aef3527e346132099a2a5a78dc16c" id="r_a3f5aef3527e346132099a2a5a78dc16c"><td class="memItemLeft" align="right" valign="top"><a id="a3f5aef3527e346132099a2a5a78dc16c" name="a3f5aef3527e346132099a2a5a78dc16c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KEY_ID_SIZE</b>&#160;&#160;&#160;4U</td></tr>
<tr class="memdesc:a3f5aef3527e346132099a2a5a78dc16c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key ID size in bytes. <br /></td></tr>
<tr class="memitem:a4a9274ad4f2c83c0315b0e88180fb478" id="r_a4a9274ad4f2c83c0315b0e88180fb478"><td class="memItemLeft" align="right" valign="top"><a id="a4a9274ad4f2c83c0315b0e88180fb478" name="a4a9274ad4f2c83c0315b0e88180fb478"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SERVICE_ID_SIZE</b>&#160;&#160;&#160;2U</td></tr>
<tr class="memdesc:a4a9274ad4f2c83c0315b0e88180fb478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Service ID size in bytes. <br /></td></tr>
<tr class="memitem:a4befa8797a1f336c6a5d4bef31f4ef0d" id="r_a4befa8797a1f336c6a5d4bef31f4ef0d"><td class="memItemLeft" align="right" valign="top"><a id="a4befa8797a1f336c6a5d4bef31f4ef0d" name="a4befa8797a1f336c6a5d4bef31f4ef0d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_DID_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#abc4ba90f4d749d5ebb8021871b677a43">SATP_DOMAIN_ID_SIZE</a> + <a class="el" href="#af18b2ae7978d8481be0d83a0f83dde9d">SATP_BRANCH_ID_SIZE</a> + <a class="el" href="#a9880cc763010b2952af9539d078195a0">SATP_EPOCH_SIZE</a> + <a class="el" href="#a4a9274ad4f2c83c0315b0e88180fb478">SATP_SERVICE_ID_SIZE</a> + <a class="el" href="#ababa3b4f9709484fb79448c6541308de">SATP_DEVICE_ID_SIZE</a>)</td></tr>
<tr class="memdesc:a4befa8797a1f336c6a5d4bef31f4ef0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The full sub-key ID size in bytes. <br /></td></tr>
<tr class="memitem:afad2aa0a7009769010e4fbd5b3229ae2" id="r_afad2aa0a7009769010e4fbd5b3229ae2"><td class="memItemLeft" align="right" valign="top"><a id="afad2aa0a7009769010e4fbd5b3229ae2" name="afad2aa0a7009769010e4fbd5b3229ae2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MID_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#abc4ba90f4d749d5ebb8021871b677a43">SATP_DOMAIN_ID_SIZE</a>)</td></tr>
<tr class="memdesc:afad2aa0a7009769010e4fbd5b3229ae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The master key identity size in bytes. <br /></td></tr>
<tr class="memitem:a16b831ff71e2d15a824a890f542e24f0" id="r_a16b831ff71e2d15a824a890f542e24f0"><td class="memItemLeft" align="right" valign="top"><a id="a16b831ff71e2d15a824a890f542e24f0" name="a16b831ff71e2d15a824a890f542e24f0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SID_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#abc4ba90f4d749d5ebb8021871b677a43">SATP_DOMAIN_ID_SIZE</a> + <a class="el" href="#af18b2ae7978d8481be0d83a0f83dde9d">SATP_BRANCH_ID_SIZE</a>)</td></tr>
<tr class="memdesc:a16b831ff71e2d15a824a890f542e24f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The server ID size in bytes. <br /></td></tr>
<tr class="memitem:a92dfd14570beaf5e896495405760777b" id="r_a92dfd14570beaf5e896495405760777b"><td class="memItemLeft" align="right" valign="top"><a id="a92dfd14570beaf5e896495405760777b" name="a92dfd14570beaf5e896495405760777b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KID_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#a4befa8797a1f336c6a5d4bef31f4ef0d">SATP_DID_SIZE</a> + <a class="el" href="#a3f5aef3527e346132099a2a5a78dc16c">SATP_KEY_ID_SIZE</a>)</td></tr>
<tr class="memdesc:a92dfd14570beaf5e896495405760777b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The key ID size in bytes. <br /></td></tr>
<tr class="memitem:a21645295558e27eed64fc61b87116747" id="r_a21645295558e27eed64fc61b87116747"><td class="memItemLeft" align="right" valign="top"><a id="a21645295558e27eed64fc61b87116747" name="a21645295558e27eed64fc61b87116747"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_DKEY_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:a21645295558e27eed64fc61b87116747"><td class="mdescLeft">&#160;</td><td class="mdescRight">The client key size in bytes. <br /></td></tr>
<tr class="memitem:a8ff169084319c479c3a8e01addeb3098" id="r_a8ff169084319c479c3a8e01addeb3098"><td class="memItemLeft" align="right" valign="top"><a id="a8ff169084319c479c3a8e01addeb3098" name="a8ff169084319c479c3a8e01addeb3098"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MKEY_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:a8ff169084319c479c3a8e01addeb3098"><td class="mdescLeft">&#160;</td><td class="mdescRight">The master key size in bytes. <br /></td></tr>
<tr class="memitem:ab89af91e1cfc71dfbb93aac6d33dd2f3" id="r_ab89af91e1cfc71dfbb93aac6d33dd2f3"><td class="memItemLeft" align="right" valign="top"><a id="ab89af91e1cfc71dfbb93aac6d33dd2f3" name="ab89af91e1cfc71dfbb93aac6d33dd2f3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SKEY_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:ab89af91e1cfc71dfbb93aac6d33dd2f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The server key size in bytes. <br /></td></tr>
<tr class="memitem:a3e297e70dd87c4d8b4c707e70e9d81c5" id="r_a3e297e70dd87c4d8b4c707e70e9d81c5"><td class="memItemLeft" align="right" valign="top"><a id="a3e297e70dd87c4d8b4c707e70e9d81c5" name="a3e297e70dd87c4d8b4c707e70e9d81c5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_KTREE_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#a21645295558e27eed64fc61b87116747">SATP_DKEY_SIZE</a> * <a class="el" href="#a7f8c8dfaa8d1d7099820c1ccef5b2672">SATP_KEY_TREE_COUNT</a>)</td></tr>
<tr class="memdesc:a3e297e70dd87c4d8b4c707e70e9d81c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The key tree size in bytes. <br /></td></tr>
<tr class="memitem:a35a9df3a6f8f338d79d2dc6ffe9c2967" id="r_a35a9df3a6f8f338d79d2dc6ffe9c2967"><td class="memItemLeft" align="right" valign="top"><a id="a35a9df3a6f8f338d79d2dc6ffe9c2967" name="a35a9df3a6f8f338d79d2dc6ffe9c2967"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_DKEY_ENCODED_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#a92dfd14570beaf5e896495405760777b">SATP_KID_SIZE</a> + <a class="el" href="#ab89af91e1cfc71dfbb93aac6d33dd2f3">SATP_SKEY_SIZE</a> + <a class="el" href="#a7f6579e0efba42857a914de8b486840d">SATP_EXPIRATION_SIZE</a> + (<a class="el" href="#a21645295558e27eed64fc61b87116747">SATP_DKEY_SIZE</a> * <a class="el" href="#a7f8c8dfaa8d1d7099820c1ccef5b2672">SATP_KEY_TREE_COUNT</a>))</td></tr>
<tr class="memdesc:a35a9df3a6f8f338d79d2dc6ffe9c2967"><td class="mdescLeft">&#160;</td><td class="mdescRight">The serialized device key size in bytes. <br /></td></tr>
<tr class="memitem:a8001eefe732bf05985c027bee597c8c4" id="r_a8001eefe732bf05985c027bee597c8c4"><td class="memItemLeft" align="right" valign="top"><a id="a8001eefe732bf05985c027bee597c8c4" name="a8001eefe732bf05985c027bee597c8c4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_MKEY_ENCODED_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#a8ff169084319c479c3a8e01addeb3098">SATP_MKEY_SIZE</a> + <a class="el" href="#afad2aa0a7009769010e4fbd5b3229ae2">SATP_MID_SIZE</a> + <a class="el" href="#a7f6579e0efba42857a914de8b486840d">SATP_EXPIRATION_SIZE</a>)</td></tr>
<tr class="memdesc:a8001eefe732bf05985c027bee597c8c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">serialized master key size in bytes. <br /></td></tr>
<tr class="memitem:ad603ccba31d8103fa9da82478d822933" id="r_ad603ccba31d8103fa9da82478d822933"><td class="memItemLeft" align="right" valign="top"><a id="ad603ccba31d8103fa9da82478d822933" name="ad603ccba31d8103fa9da82478d822933"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_SKEY_ENCODED_SIZE</b>&#160;&#160;&#160;(<a class="el" href="#ab89af91e1cfc71dfbb93aac6d33dd2f3">SATP_SKEY_SIZE</a> + <a class="el" href="#ab89af91e1cfc71dfbb93aac6d33dd2f3">SATP_SKEY_SIZE</a> + <a class="el" href="#a16b831ff71e2d15a824a890f542e24f0">SATP_SID_SIZE</a> + <a class="el" href="#a7f6579e0efba42857a914de8b486840d">SATP_EXPIRATION_SIZE</a>)</td></tr>
<tr class="memdesc:ad603ccba31d8103fa9da82478d822933"><td class="mdescLeft">&#160;</td><td class="mdescRight">serialized server key size in bytes. <br /></td></tr>
<tr class="memitem:ae4de8c9d946143beaa6eea71bebbd513" id="r_ae4de8c9d946143beaa6eea71bebbd513"><td class="memItemLeft" align="right" valign="top"><a id="ae4de8c9d946143beaa6eea71bebbd513" name="ae4de8c9d946143beaa6eea71bebbd513"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SATP_STOK_SIZE</b>&#160;&#160;&#160;32U</td></tr>
<tr class="memdesc:ae4de8c9d946143beaa6eea71bebbd513"><td class="mdescLeft">&#160;</td><td class="mdescRight">The session token size in bytes. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-typedef-members" class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a1c373c84a5d65b6e1d6892b9324ac500" id="r_a1c373c84a5d65b6e1d6892b9324ac500"><td class="memItemLeft" align="right" valign="top"><a id="a1c373c84a5d65b6e1d6892b9324ac500" name="a1c373c84a5d65b6e1d6892b9324ac500"></a>
typedef SATP_EXPORT_API enum <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><b>satp_errors</b></td></tr>
<tr class="memitem:a0778ec80548c30cdba3266e6222277f9" id="r_a0778ec80548c30cdba3266e6222277f9"><td class="memItemLeft" align="right" valign="top"><a id="a0778ec80548c30cdba3266e6222277f9" name="a0778ec80548c30cdba3266e6222277f9"></a>
typedef SATP_EXPORT_API enum <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a>&#160;</td><td class="memItemRight" valign="bottom"><b>satp_flags</b></td></tr>
<tr class="memitem:afc7fd970fda3e336b103a5b87c6fc0f5" id="r_afc7fd970fda3e336b103a5b87c6fc0f5"><td class="memItemLeft" align="right" valign="top"><a id="afc7fd970fda3e336b103a5b87c6fc0f5" name="afc7fd970fda3e336b103a5b87c6fc0f5"></a>
typedef SATP_EXPORT_API struct satp_connection_state&#160;</td><td class="memItemRight" valign="bottom"><b>satp_connection_state</b></td></tr>
<tr class="memitem:af54231a15be201f57ea8f7386a71de81" id="r_af54231a15be201f57ea8f7386a71de81"><td class="memItemLeft" align="right" valign="top"><a id="af54231a15be201f57ea8f7386a71de81" name="af54231a15be201f57ea8f7386a71de81"></a>
typedef SATP_EXPORT_API struct satp_device_key&#160;</td><td class="memItemRight" valign="bottom"><b>satp_device_key</b></td></tr>
<tr class="memitem:a849fd59f2cd02c096fb89ea02b1ad9d9" id="r_a849fd59f2cd02c096fb89ea02b1ad9d9"><td class="memItemLeft" align="right" valign="top"><a id="a849fd59f2cd02c096fb89ea02b1ad9d9" name="a849fd59f2cd02c096fb89ea02b1ad9d9"></a>
typedef SATP_EXPORT_API struct satp_master_key&#160;</td><td class="memItemRight" valign="bottom"><b>satp_master_key</b></td></tr>
<tr class="memitem:a0159f37c586d7b3f90fb10ca0ff8e023" id="r_a0159f37c586d7b3f90fb10ca0ff8e023"><td class="memItemLeft" align="right" valign="top"><a id="a0159f37c586d7b3f90fb10ca0ff8e023" name="a0159f37c586d7b3f90fb10ca0ff8e023"></a>
typedef SATP_EXPORT_API struct satp_server_key&#160;</td><td class="memItemRight" valign="bottom"><b>satp_server_key</b></td></tr>
<tr class="memitem:a88c94728bbd992eaebb30a3be400ef44" id="r_a88c94728bbd992eaebb30a3be400ef44"><td class="memItemLeft" align="right" valign="top"><a id="a88c94728bbd992eaebb30a3be400ef44" name="a88c94728bbd992eaebb30a3be400ef44"></a>
typedef SATP_EXPORT_API struct <a class="el" href="structqsmp__keep__alive__state.html">qsmp_keep_alive_state</a>&#160;</td><td class="memItemRight" valign="bottom"><b>satp_keep_alive_state</b></td></tr>
<tr class="memitem:abef6fd356e8c888895885215561dda05" id="r_abef6fd356e8c888895885215561dda05"><td class="memItemLeft" align="right" valign="top"><a id="abef6fd356e8c888895885215561dda05" name="abef6fd356e8c888895885215561dda05"></a>
typedef SATP_EXPORT_API struct satp_network_packet&#160;</td><td class="memItemRight" valign="bottom"><b>satp_network_packet</b></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-enum-members" class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad018e7d955cb389223bcc7e5d8a38c5a" id="r_ad018e7d955cb389223bcc7e5d8a38c5a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> { <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aae0bd1ffa173ecefde1602fc4312b82d2">satp_error_none</a> = 0x00U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aae9ed7692ea5ebb387f5ad7ab551675ec">satp_error_accept_fail</a> = 0x01
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa201ca1ee4a2d2a7b46ca15ce60c70c73">satp_error_authentication_failure</a> = 0x02U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aae319c9039652d5dc7fdeece9e2c0323b">satp_error_authentication_success</a> = 0x03U
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa298d0eeaed1477349c6e03d5ed535c0d">satp_erroe_listen_fail</a> = 0x04U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa4b0c8f20e3212dd1a32cfd4c6f5dabb8">satp_error_allocation_failure</a> = 0x05U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa5b4dd0b9aac0f5da5a393c67ea3212fd">satp_error_bad_keep_alive</a> = 0x06U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa9c818a084e31c65dac8a64ecd3561b77">satp_error_cipher_auth_failure</a> = 0x07U
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aac82788262b7d94d77cd96448c2c1046f">satp_error_channel_down</a> = 0x08U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aab067e0737d6e3ddeb948937fc2f2a20a">satp_error_connection_failure</a> = 0x09U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa6773dd68788a41abaafad2626fc66f36">satp_error_decryption_failure</a> = 0x0AU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aaf54201a835177b6e645071eef3f4690f">satp_error_device_unrecognized</a> = 0x0BU
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa904e1e37972dd8d5b6ef11c822183c16">satp_error_establish_failure</a> = 0x0CU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa7c1510995d45f8ac5efad74764eb6947">satp_error_hosts_exceeded</a> = 0x0DU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa0f36a9a467bca90f55dcf574505315cd">satp_error_invalid_input</a> = 0x0EU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa9de012221558389cfcba4f20471d53fe">satp_error_invalid_request</a> = 0x0FU
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa8f1b47365c31d684ae30eb80622d3282">satp_error_keep_alive_expired</a> = 0x10U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa2c6e1ff643be3df77b13edcffe9d6f87">satp_error_kex_auth_failure</a> = 0x11U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa95c284acdbb9926ffa35f11d1b26a809">satp_error_key_expired</a> = 0x12U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa7c9daf25b67b3467154d82da7c4a184d">satp_error_key_not_recognized</a> = 0x13U
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa5b3b79d832d4124935169bf67be1cbf7">satp_error_listener_fail</a> = 0x14U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aaf59560eee974a0abb7ae8bc1a7b7001e">satp_error_message_time_invalid</a> = 0x15U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa8217e9c14802c70fdf7800a4bd784c12">satp_error_packet_expired</a> = 0x16U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa846f1642f543dd051d40db797f5039db">satp_error_packet_unsequenced</a> = 0x17U
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa0d95f0095b9015fcc63c557957a678f6">satp_error_random_failure</a> = 0x18U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aaf978ec059e4a360e2d2f3e1e12b79618">satp_error_receive_failure</a> = 0x19U
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aac827f214b70ab0a2a415bd6004418da0">satp_error_transmit_failure</a> = 0x1AU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa0a53f61ddd8c8dd1aab552a7e72a746e">satp_error_unknown_protocol</a> = 0x1BU
, <br />
&#160;&#160;<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aae4ae8e656692a07a8c36a38ebf16dfac">satp_error_unsequenced</a> = 0x1CU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aaef9010303da834586eb63e71664f6962">satp_error_verify_failure</a> = 0x1DU
, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5aa3d706ae2143988c8e1cdbf31703589da">satp_error_general_failure</a> = 0xFFU
<br />
 }</td></tr>
<tr class="memdesc:ad018e7d955cb389223bcc7e5d8a38c5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP error values. This enumeration defines the error codes returned by SATP functions.  <a href="#ad018e7d955cb389223bcc7e5d8a38c5a">More...</a><br /></td></tr>
<tr class="memitem:ad066a34f2d7493aac88b3d386f0bbd4e" id="r_ad066a34f2d7493aac88b3d386f0bbd4e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a> { <br />
&#160;&#160;<a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea28bca8366091302d8ea83fbcb27c8414">satp_flag_none</a> = 0x00U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4eac589dc859e24be990d2f883382dbb8ec">satp_flag_connect_request</a> = 0x01U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea4734a78ed94a982901291eb6da46f093">satp_flag_connect_response</a> = 0x02U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea28b787cd4b0990423d6287ff7e7e023b">satp_flag_connection_terminate</a> = 0x03U
, <br />
&#160;&#160;<a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea8788180430fed49cc83a6f558322194b">satp_flag_encrypted_message</a> = 0x04U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea5ccea056fdb79fcfaea6e21307348e17">satp_flag_authentication_request</a> = 0x05U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea54b0410100520e2009f636c639ec2fc5">satp_flag_authentication_response</a> = 0x06U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea628018af4907fd9d45a58fea8aba343e">satp_flag_auth_verify</a> = 0x08U
, <br />
&#160;&#160;<a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4eab8fe0aa54700879bac861d7b564522ed">satp_flag_keepalive_request</a> = 0x09U
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4eaa741c190841ad6cf4a18d36f38c2a992">satp_flag_session_established</a> = 0x0AU
, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4ea424f30de28eb65d70844f879e5e3b484">satp_flag_error_condition</a> = 0xFFU
<br />
 }</td></tr>
<tr class="memdesc:ad066a34f2d7493aac88b3d386f0bbd4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SATP packet flag values. This enumeration defines the flag values used in SATP packets to indicate the type and purpose of the packet.  <a href="#ad066a34f2d7493aac88b3d386f0bbd4e">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9b7fb21d98c6ca889a0053a2fb8e685c" id="r_a9b7fb21d98c6ca889a0053a2fb8e685c"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b7fb21d98c6ca889a0053a2fb8e685c">satp_connection_close</a> (<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *cns, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> err, bool notify)</td></tr>
<tr class="memdesc:a9b7fb21d98c6ca889a0053a2fb8e685c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the network connection between hosts.  <br /></td></tr>
<tr class="memitem:a730dc6b96a4fc8b9880552f02e74e1a6" id="r_a730dc6b96a4fc8b9880552f02e74e1a6"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a730dc6b96a4fc8b9880552f02e74e1a6">satp_connection_dispose</a> (<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *cns)</td></tr>
<tr class="memdesc:a730dc6b96a4fc8b9880552f02e74e1a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the connection state.  <br /></td></tr>
<tr class="memitem:aadf6227ad6889be02b6321c23ed822f8" id="r_aadf6227ad6889be02b6321c23ed822f8"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aadf6227ad6889be02b6321c23ed822f8">satp_decrypt_error_message</a> (<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *cns, uint8_t *message)</td></tr>
<tr class="memdesc:aadf6227ad6889be02b6321c23ed822f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt an error message.  <br /></td></tr>
<tr class="memitem:a99fbb5fb645a8da4665f1c7b3a8a2075" id="r_a99fbb5fb645a8da4665f1c7b3a8a2075"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99fbb5fb645a8da4665f1c7b3a8a2075">satp_decrypt_packet</a> (<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *cns, const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packetin, uint8_t *message, size_t *msglen)</td></tr>
<tr class="memdesc:a99fbb5fb645a8da4665f1c7b3a8a2075"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt an SATP packet.  <br /></td></tr>
<tr class="memitem:a0c056dd561cc1e3d59136fbf934dac12" id="r_a0c056dd561cc1e3d59136fbf934dac12"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c056dd561cc1e3d59136fbf934dac12">satp_encrypt_packet</a> (<a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *cns, const uint8_t *message, size_t msglen, <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packetout)</td></tr>
<tr class="memdesc:a0c056dd561cc1e3d59136fbf934dac12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a message into an SATP packet.  <br /></td></tr>
<tr class="memitem:a1c4bab130e2a50f12a332e78c31dba37" id="r_a1c4bab130e2a50f12a332e78c31dba37"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c4bab130e2a50f12a332e78c31dba37">satp_deserialize_device_key</a> (<a class="el" href="structsatp__device__key.html">satp_device_key</a> *dkey, const uint8_t *input)</td></tr>
<tr class="memdesc:a1c4bab130e2a50f12a332e78c31dba37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize a client device key. This function deserializes a byte array into a SATP device key structure.  <br /></td></tr>
<tr class="memitem:a48d598ef3325f5fbe95a3ed88a017088" id="r_a48d598ef3325f5fbe95a3ed88a017088"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48d598ef3325f5fbe95a3ed88a017088">satp_serialize_device_key</a> (uint8_t *output, const <a class="el" href="structsatp__device__key.html">satp_device_key</a> *dkey)</td></tr>
<tr class="memdesc:a48d598ef3325f5fbe95a3ed88a017088"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize a client device key. This function serializes a SATP device key structure into a byte array.  <br /></td></tr>
<tr class="memitem:aee061dfbc12a598fb47393ee37288be5" id="r_aee061dfbc12a598fb47393ee37288be5"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee061dfbc12a598fb47393ee37288be5">satp_error_to_string</a> (<a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> error)</td></tr>
<tr class="memdesc:aee061dfbc12a598fb47393ee37288be5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a string description of an SATP error code. This function returns a human-readable string corresponding to the provided SATP error code.  <br /></td></tr>
<tr class="memitem:aaa2e0f35cac6e54840a8796077096bc0" id="r_aaa2e0f35cac6e54840a8796077096bc0"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa2e0f35cac6e54840a8796077096bc0">satp_extract_device_key</a> (uint8_t *dk, const uint8_t *sk, const uint8_t *kid)</td></tr>
<tr class="memdesc:aaa2e0f35cac6e54840a8796077096bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a device key. This function extracts a device key by hashing the server key and key identity.  <br /></td></tr>
<tr class="memitem:a3a799bd9ea26e386e6fead4a6b43ca64" id="r_a3a799bd9ea26e386e6fead4a6b43ca64"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a799bd9ea26e386e6fead4a6b43ca64">satp_packet_error_message</a> (<a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> error)</td></tr>
<tr class="memdesc:a3a799bd9ea26e386e6fead4a6b43ca64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populate a packet structure with an error message.  <br /></td></tr>
<tr class="memitem:ab1c0af0699f00c99b2922c5a0de00ccf" id="r_ab1c0af0699f00c99b2922c5a0de00ccf"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1c0af0699f00c99b2922c5a0de00ccf">satp_deserialize_master_key</a> (<a class="el" href="structsatp__master__key.html">satp_master_key</a> *mkey, const uint8_t *input)</td></tr>
<tr class="memdesc:ab1c0af0699f00c99b2922c5a0de00ccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize a master key from a byte array. This function deserializes a byte array into a SATP master key structure.  <br /></td></tr>
<tr class="memitem:ae99fd2e7baae45f495dc6233320362cf" id="r_ae99fd2e7baae45f495dc6233320362cf"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae99fd2e7baae45f495dc6233320362cf">satp_serialize_master_key</a> (uint8_t *output, const <a class="el" href="structsatp__master__key.html">satp_master_key</a> *mkey)</td></tr>
<tr class="memdesc:ae99fd2e7baae45f495dc6233320362cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize a master key into a byte array. This function serializes a SATP master key structure into a byte array.  <br /></td></tr>
<tr class="memitem:a7998cf2a551b7c4fcf6fbdfcf9ba6ec9" id="r_a7998cf2a551b7c4fcf6fbdfcf9ba6ec9"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7998cf2a551b7c4fcf6fbdfcf9ba6ec9">satp_deserialize_server_key</a> (<a class="el" href="structsatp__server__key.html">satp_server_key</a> *skey, const uint8_t *input)</td></tr>
<tr class="memdesc:a7998cf2a551b7c4fcf6fbdfcf9ba6ec9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize a server key from a byte array. This function deserializes a byte array into a SATP server key structure.  <br /></td></tr>
<tr class="memitem:a47a1c8f31535ac24db7aa5aa6baf9817" id="r_a47a1c8f31535ac24db7aa5aa6baf9817"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47a1c8f31535ac24db7aa5aa6baf9817">satp_serialize_server_key</a> (uint8_t *output, const <a class="el" href="structsatp__server__key.html">satp_server_key</a> *skey)</td></tr>
<tr class="memdesc:a47a1c8f31535ac24db7aa5aa6baf9817"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize a server key into a byte array. This function serializes a SATP server key structure into a byte array.  <br /></td></tr>
<tr class="memitem:a0cc1070b8e5286a63d637aa24bf1850c" id="r_a0cc1070b8e5286a63d637aa24bf1850c"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cc1070b8e5286a63d637aa24bf1850c">satp_increment_device_key</a> (uint8_t *sdkey)</td></tr>
<tr class="memdesc:a0cc1070b8e5286a63d637aa24bf1850c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the serialized key This function clears a key at the current position and increments the kid counter.  <br /></td></tr>
<tr class="memitem:a281a41da487bc334fab7819ee9c02945" id="r_a281a41da487bc334fab7819ee9c02945"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a281a41da487bc334fab7819ee9c02945">satp_generate_master_key</a> (<a class="el" href="structsatp__master__key.html">satp_master_key</a> *mkey, const uint8_t *mid)</td></tr>
<tr class="memdesc:a281a41da487bc334fab7819ee9c02945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a master key-set. This function generates a new SATP master key-set. It populates the provided master key structure with a randomly generated master derivation key and the key identity, and sets the expiration time. The master key serves as the root from which branch keys are derived.  <br /></td></tr>
<tr class="memitem:a59c530e1cf72b42b6f52771d9afecb15" id="r_a59c530e1cf72b42b6f52771d9afecb15"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59c530e1cf72b42b6f52771d9afecb15">satp_generate_server_key</a> (<a class="el" href="structsatp__server__key.html">satp_server_key</a> *skey, const <a class="el" href="structsatp__master__key.html">satp_master_key</a> *mkey, const uint8_t *sid)</td></tr>
<tr class="memdesc:a59c530e1cf72b42b6f52771d9afecb15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a server key-set. This function generates a new SATP server key-set based on the provided master key. It populates the server key structure with a derived server key and sets the key identity and expiration time.  <br /></td></tr>
<tr class="memitem:a77c0d2627e573b0ab6392e020f2827fc" id="r_a77c0d2627e573b0ab6392e020f2827fc"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a77c0d2627e573b0ab6392e020f2827fc">satp_generate_device_key</a> (<a class="el" href="structsatp__device__key.html">satp_device_key</a> *dkey, const <a class="el" href="structsatp__server__key.html">satp_server_key</a> *skey, const uint8_t *did)</td></tr>
<tr class="memdesc:a77c0d2627e573b0ab6392e020f2827fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a device key-set. This function generates a new SATP device key-set using the provided server key. It derives the device key from the server key and sets the key identity and expiration time.  <br /></td></tr>
<tr class="memitem:a1f46c173b5fb7d35837a70403572a407" id="r_a1f46c173b5fb7d35837a70403572a407"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f46c173b5fb7d35837a70403572a407">satp_packet_clear</a> (<a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet)</td></tr>
<tr class="memdesc:a1f46c173b5fb7d35837a70403572a407"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear a SATP network packet. This function resets the fields of a SATP network packet to zero, effectively clearing its state.  <br /></td></tr>
<tr class="memitem:acf0a09fd626ef1c139b89f0c1f3ba025" id="r_acf0a09fd626ef1c139b89f0c1f3ba025"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf0a09fd626ef1c139b89f0c1f3ba025">satp_packet_header_create</a> (<a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packetout, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a> flag, uint64_t sequence, uint32_t msglen)</td></tr>
<tr class="memdesc:acf0a09fd626ef1c139b89f0c1f3ba025"><td class="mdescLeft">&#160;</td><td class="mdescRight">Populate a packet header and set the creation time.  <br /></td></tr>
<tr class="memitem:a9e349323de91e572ec561f0178e65c80" id="r_a9e349323de91e572ec561f0178e65c80"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9e349323de91e572ec561f0178e65c80">satp_packet_header_deserialize</a> (const uint8_t *header, <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet)</td></tr>
<tr class="memdesc:a9e349323de91e572ec561f0178e65c80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize a byte array into a SATP packet header. This function converts a serialized byte array representing a SATP packet header into a structured SATP network packet.  <br /></td></tr>
<tr class="memitem:a4a2e702a3fc5f396d04d3e6154a99e7b" id="r_a4a2e702a3fc5f396d04d3e6154a99e7b"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a2e702a3fc5f396d04d3e6154a99e7b">satp_packet_header_serialize</a> (const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet, uint8_t *header)</td></tr>
<tr class="memdesc:a4a2e702a3fc5f396d04d3e6154a99e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize a SATP packet header into a byte array. This function converts a structured SATP network packet header into a serialized byte array for transmission.  <br /></td></tr>
<tr class="memitem:a0b08296d5bd696384523cdf09a228b6b" id="r_a0b08296d5bd696384523cdf09a228b6b"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b08296d5bd696384523cdf09a228b6b">satp_packet_header_validate</a> (const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packetin, <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a> pktflag, uint64_t sequence, uint32_t msglen)</td></tr>
<tr class="memdesc:a0b08296d5bd696384523cdf09a228b6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a packet header and timestamp.  <br /></td></tr>
<tr class="memitem:affba3463edb0696a2478b3c488292cae" id="r_affba3463edb0696a2478b3c488292cae"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#affba3463edb0696a2478b3c488292cae">satp_packet_set_utc_time</a> (<a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet)</td></tr>
<tr class="memdesc:affba3463edb0696a2478b3c488292cae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the local UTC seconds time in a SATP packet header. This function updates the SATP packet header with the current UTC time (in seconds).  <br /></td></tr>
<tr class="memitem:a2d7472a57310d89dea3fe523071cf3cc" id="r_a2d7472a57310d89dea3fe523071cf3cc"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d7472a57310d89dea3fe523071cf3cc">satp_packet_time_valid</a> (const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet)</td></tr>
<tr class="memdesc:a2d7472a57310d89dea3fe523071cf3cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a SATP packet is received within the valid time threshold. This function compares the UTC time in the SATP packet header against the local time to verify that the packet was received within the allowed time threshold.  <br /></td></tr>
<tr class="memitem:a397497c605ec6309d2bf676596037f40" id="r_a397497c605ec6309d2bf676596037f40"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a397497c605ec6309d2bf676596037f40">satp_packet_to_stream</a> (const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet, uint8_t *pstream)</td></tr>
<tr class="memdesc:a397497c605ec6309d2bf676596037f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serialize a SATP packet into a byte array. This function converts a SATP network packet into a contiguous byte stream suitable for network transmission.  <br /></td></tr>
<tr class="memitem:a1bd090965292a0a9e373b26751a9bbe2" id="r_a1bd090965292a0a9e373b26751a9bbe2"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1bd090965292a0a9e373b26751a9bbe2">satp_send_network_error</a> (const qsc_socket *sock, <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> error)</td></tr>
<tr class="memdesc:a1bd090965292a0a9e373b26751a9bbe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a plaintext SATP network error message Used only during key exchange, the connection close is sent over an encrypted tunnel.  <br /></td></tr>
<tr class="memitem:a87ff5101cfbe562d11ae3acab708d638" id="r_a87ff5101cfbe562d11ae3acab708d638"><td class="memItemLeft" align="right" valign="top">SATP_EXPORT_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87ff5101cfbe562d11ae3acab708d638">satp_stream_to_packet</a> (const uint8_t *pstream, <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *packet)</td></tr>
<tr class="memdesc:a87ff5101cfbe562d11ae3acab708d638"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserialize a byte stream into a SATP network packet. This function converts a contiguous byte stream into a structured SATP network packet.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SATP support header Common defined parameters and functions of the SATP client and server implementations. </p>
<p>The SATP settings.</p>
<p>This header defines the configuration parameters, macros, and constants used in the Symmetric Key Distribution Protocol (SATP). SATP is designed to securely distribute symmetric keys between a master, server, device, and session while providing forward secrecy. The protocol employs ephemeral keys for each session, ensuring that even if a device or server key is compromised, past communications remain secure.</p>
<p>SATP is structured into several phases:</p>
<ul>
<li><b>Connect Request:</b> The client sends its identity string, configuration string, and a random session token to the server. The client computes a device session hash from its device ID, configuration, and token.</li>
<li><b>Connect Response:</b> The server verifies the client's configuration and key identity, generates its own session token, computes its session hash, and responds with its server ID, configuration string, and token.</li>
<li><b>Exchange Request:</b> The client generates a secret random token key, derives encryption and MAC keys using a combination of its device session hash and embedded key, and then encrypts and MACs the secret token before sending it to the server.</li>
<li><b>Exchange Response:</b> The server verifies the MAC, decrypts the token, and derives the receive channel cipher key using its embedded key and the client's device session hash.</li>
<li><b>Establish Request:</b> The client verifies the server's token hash and, if valid, encrypts its key identity to send to the server.</li>
<li><b>Establish Response:</b> The server decrypts and verifies the key identity, then re-encrypts and echoes it back.</li>
<li><b>Establish Verify:</b> The client decrypts the echoed key identity and verifies it, thereby finalizing the established session.</li>
</ul>
<p>In addition, this header defines sizes for configuration strings, error messages, expiration fields, packet headers, keepalive messages, and various key and identity fields, ensuring consistency across SATP implementations.</p>
<dl class="section note"><dt>Note</dt><dd>The SATP settings provided herein are critical for the proper operation and security of the key distribution process. </dd></dl>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="ab85d8ae0229ca75b7de3d1e3f149efd2" name="ab85d8ae0229ca75b7de3d1e3f149efd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab85d8ae0229ca75b7de3d1e3f149efd2">&#9670;&#160;</a></span>SATP_PACKET_TIME_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SATP_PACKET_TIME_THRESHOLD&#160;&#160;&#160;60U</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The maximum number of seconds a packet is considered valid. </p>
<p>On networks with a shared (NTP) time source, this may be set to as low as 1 second. On exterior networks, it should be adjusted (typically between 30 and 100 seconds) to account for clock differences. </p>

</div>
</div>
<a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Enumeration Type Documentation</h2>
<a id="ad018e7d955cb389223bcc7e5d8a38c5a" name="ad018e7d955cb389223bcc7e5d8a38c5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad018e7d955cb389223bcc7e5d8a38c5a">&#9670;&#160;</a></span>satp_errors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The SATP error values. This enumeration defines the error codes returned by SATP functions. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aae0bd1ffa173ecefde1602fc4312b82d2" name="ad018e7d955cb389223bcc7e5d8a38c5aae0bd1ffa173ecefde1602fc4312b82d2"></a>satp_error_none&#160;</td><td class="fielddoc"><p>No error was detected </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aae9ed7692ea5ebb387f5ad7ab551675ec" name="ad018e7d955cb389223bcc7e5d8a38c5aae9ed7692ea5ebb387f5ad7ab551675ec"></a>satp_error_accept_fail&#160;</td><td class="fielddoc"><p>The socket accept failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa201ca1ee4a2d2a7b46ca15ce60c70c73" name="ad018e7d955cb389223bcc7e5d8a38c5aa201ca1ee4a2d2a7b46ca15ce60c70c73"></a>satp_error_authentication_failure&#160;</td><td class="fielddoc"><p>The authentication failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aae319c9039652d5dc7fdeece9e2c0323b" name="ad018e7d955cb389223bcc7e5d8a38c5aae319c9039652d5dc7fdeece9e2c0323b"></a>satp_error_authentication_success&#160;</td><td class="fielddoc"><p>The authentication succeeded </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa298d0eeaed1477349c6e03d5ed535c0d" name="ad018e7d955cb389223bcc7e5d8a38c5aa298d0eeaed1477349c6e03d5ed535c0d"></a>satp_erroe_listen_fail&#160;</td><td class="fielddoc"><p>The listener socket could not connect </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa4b0c8f20e3212dd1a32cfd4c6f5dabb8" name="ad018e7d955cb389223bcc7e5d8a38c5aa4b0c8f20e3212dd1a32cfd4c6f5dabb8"></a>satp_error_allocation_failure&#160;</td><td class="fielddoc"><p>The memory could not be allocated </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa5b4dd0b9aac0f5da5a393c67ea3212fd" name="ad018e7d955cb389223bcc7e5d8a38c5aa5b4dd0b9aac0f5da5a393c67ea3212fd"></a>satp_error_bad_keep_alive&#160;</td><td class="fielddoc"><p>The keep alive check failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa9c818a084e31c65dac8a64ecd3561b77" name="ad018e7d955cb389223bcc7e5d8a38c5aa9c818a084e31c65dac8a64ecd3561b77"></a>satp_error_cipher_auth_failure&#160;</td><td class="fielddoc"><p>The cipher authentication has failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aac82788262b7d94d77cd96448c2c1046f" name="ad018e7d955cb389223bcc7e5d8a38c5aac82788262b7d94d77cd96448c2c1046f"></a>satp_error_channel_down&#160;</td><td class="fielddoc"><p>The communications channel has failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aab067e0737d6e3ddeb948937fc2f2a20a" name="ad018e7d955cb389223bcc7e5d8a38c5aab067e0737d6e3ddeb948937fc2f2a20a"></a>satp_error_connection_failure&#160;</td><td class="fielddoc"><p>The device could not make a connection to the remote host </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa6773dd68788a41abaafad2626fc66f36" name="ad018e7d955cb389223bcc7e5d8a38c5aa6773dd68788a41abaafad2626fc66f36"></a>satp_error_decryption_failure&#160;</td><td class="fielddoc"><p>The decryption authentication has failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aaf54201a835177b6e645071eef3f4690f" name="ad018e7d955cb389223bcc7e5d8a38c5aaf54201a835177b6e645071eef3f4690f"></a>satp_error_device_unrecognized&#160;</td><td class="fielddoc"><p>The device identity is unrecognized </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa904e1e37972dd8d5b6ef11c822183c16" name="ad018e7d955cb389223bcc7e5d8a38c5aa904e1e37972dd8d5b6ef11c822183c16"></a>satp_error_establish_failure&#160;</td><td class="fielddoc"><p>The transmission failed at the key exchange establish phase </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa7c1510995d45f8ac5efad74764eb6947" name="ad018e7d955cb389223bcc7e5d8a38c5aa7c1510995d45f8ac5efad74764eb6947"></a>satp_error_hosts_exceeded&#160;</td><td class="fielddoc"><p>The server has run out of socket connections </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa0f36a9a467bca90f55dcf574505315cd" name="ad018e7d955cb389223bcc7e5d8a38c5aa0f36a9a467bca90f55dcf574505315cd"></a>satp_error_invalid_input&#160;</td><td class="fielddoc"><p>The input provided is invalid </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa9de012221558389cfcba4f20471d53fe" name="ad018e7d955cb389223bcc7e5d8a38c5aa9de012221558389cfcba4f20471d53fe"></a>satp_error_invalid_request&#160;</td><td class="fielddoc"><p>The packet flag was unexpected </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa8f1b47365c31d684ae30eb80622d3282" name="ad018e7d955cb389223bcc7e5d8a38c5aa8f1b47365c31d684ae30eb80622d3282"></a>satp_error_keep_alive_expired&#160;</td><td class="fielddoc"><p>The keep alive has expired with no response </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa2c6e1ff643be3df77b13edcffe9d6f87" name="ad018e7d955cb389223bcc7e5d8a38c5aa2c6e1ff643be3df77b13edcffe9d6f87"></a>satp_error_kex_auth_failure&#160;</td><td class="fielddoc"><p>The key exchange authentication has failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa95c284acdbb9926ffa35f11d1b26a809" name="ad018e7d955cb389223bcc7e5d8a38c5aa95c284acdbb9926ffa35f11d1b26a809"></a>satp_error_key_expired&#160;</td><td class="fielddoc"><p>The SATP public key has expired </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa7c9daf25b67b3467154d82da7c4a184d" name="ad018e7d955cb389223bcc7e5d8a38c5aa7c9daf25b67b3467154d82da7c4a184d"></a>satp_error_key_not_recognized&#160;</td><td class="fielddoc"><p>The key identity is not recognized </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa5b3b79d832d4124935169bf67be1cbf7" name="ad018e7d955cb389223bcc7e5d8a38c5aa5b3b79d832d4124935169bf67be1cbf7"></a>satp_error_listener_fail&#160;</td><td class="fielddoc"><p>The listener function failed to initialize </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aaf59560eee974a0abb7ae8bc1a7b7001e" name="ad018e7d955cb389223bcc7e5d8a38c5aaf59560eee974a0abb7ae8bc1a7b7001e"></a>satp_error_message_time_invalid&#160;</td><td class="fielddoc"><p>The packet has valid time expired </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa8217e9c14802c70fdf7800a4bd784c12" name="ad018e7d955cb389223bcc7e5d8a38c5aa8217e9c14802c70fdf7800a4bd784c12"></a>satp_error_packet_expired&#160;</td><td class="fielddoc"><p>The packet keep alive is invalid </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa846f1642f543dd051d40db797f5039db" name="ad018e7d955cb389223bcc7e5d8a38c5aa846f1642f543dd051d40db797f5039db"></a>satp_error_packet_unsequenced&#160;</td><td class="fielddoc"><p>The packet was received out of sequence </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa0d95f0095b9015fcc63c557957a678f6" name="ad018e7d955cb389223bcc7e5d8a38c5aa0d95f0095b9015fcc63c557957a678f6"></a>satp_error_random_failure&#160;</td><td class="fielddoc"><p>The random generator has failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aaf978ec059e4a360e2d2f3e1e12b79618" name="ad018e7d955cb389223bcc7e5d8a38c5aaf978ec059e4a360e2d2f3e1e12b79618"></a>satp_error_receive_failure&#160;</td><td class="fielddoc"><p>The receiver failed at the network layer </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aac827f214b70ab0a2a415bd6004418da0" name="ad018e7d955cb389223bcc7e5d8a38c5aac827f214b70ab0a2a415bd6004418da0"></a>satp_error_transmit_failure&#160;</td><td class="fielddoc"><p>The transmitter failed at the network layer </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa0a53f61ddd8c8dd1aab552a7e72a746e" name="ad018e7d955cb389223bcc7e5d8a38c5aa0a53f61ddd8c8dd1aab552a7e72a746e"></a>satp_error_unknown_protocol&#160;</td><td class="fielddoc"><p>The protocol string was not recognized </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aae4ae8e656692a07a8c36a38ebf16dfac" name="ad018e7d955cb389223bcc7e5d8a38c5aae4ae8e656692a07a8c36a38ebf16dfac"></a>satp_error_unsequenced&#160;</td><td class="fielddoc"><p>The packets sequence number is out of sync </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aaef9010303da834586eb63e71664f6962" name="ad018e7d955cb389223bcc7e5d8a38c5aaef9010303da834586eb63e71664f6962"></a>satp_error_verify_failure&#160;</td><td class="fielddoc"><p>The expected data could not be verified </p>
</td></tr>
<tr><td class="fieldname"><a id="ad018e7d955cb389223bcc7e5d8a38c5aa3d706ae2143988c8e1cdbf31703589da" name="ad018e7d955cb389223bcc7e5d8a38c5aa3d706ae2143988c8e1cdbf31703589da"></a>satp_error_general_failure&#160;</td><td class="fielddoc"><p>A general failure occurred </p>
</td></tr>
</table>

</div>
</div>
<a id="ad066a34f2d7493aac88b3d386f0bbd4e" name="ad066a34f2d7493aac88b3d386f0bbd4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad066a34f2d7493aac88b3d386f0bbd4e">&#9670;&#160;</a></span>satp_flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The SATP packet flag values. This enumeration defines the flag values used in SATP packets to indicate the type and purpose of the packet. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea28bca8366091302d8ea83fbcb27c8414" name="ad066a34f2d7493aac88b3d386f0bbd4ea28bca8366091302d8ea83fbcb27c8414"></a>satp_flag_none&#160;</td><td class="fielddoc"><p>No flag was selected </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4eac589dc859e24be990d2f883382dbb8ec" name="ad066a34f2d7493aac88b3d386f0bbd4eac589dc859e24be990d2f883382dbb8ec"></a>satp_flag_connect_request&#160;</td><td class="fielddoc"><p>The packet contains a connection request </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea4734a78ed94a982901291eb6da46f093" name="ad066a34f2d7493aac88b3d386f0bbd4ea4734a78ed94a982901291eb6da46f093"></a>satp_flag_connect_response&#160;</td><td class="fielddoc"><p>The packet contains a connection response </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea28b787cd4b0990423d6287ff7e7e023b" name="ad066a34f2d7493aac88b3d386f0bbd4ea28b787cd4b0990423d6287ff7e7e023b"></a>satp_flag_connection_terminate&#160;</td><td class="fielddoc"><p>Indicates that the connection is to be terminated </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea8788180430fed49cc83a6f558322194b" name="ad066a34f2d7493aac88b3d386f0bbd4ea8788180430fed49cc83a6f558322194b"></a>satp_flag_encrypted_message&#160;</td><td class="fielddoc"><p>The packet contains an encrypted message </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea5ccea056fdb79fcfaea6e21307348e17" name="ad066a34f2d7493aac88b3d386f0bbd4ea5ccea056fdb79fcfaea6e21307348e17"></a>satp_flag_authentication_request&#160;</td><td class="fielddoc"><p>The packet contains an authentication request </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea54b0410100520e2009f636c639ec2fc5" name="ad066a34f2d7493aac88b3d386f0bbd4ea54b0410100520e2009f636c639ec2fc5"></a>satp_flag_authentication_response&#160;</td><td class="fielddoc"><p>The packet contains an authentication response </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea628018af4907fd9d45a58fea8aba343e" name="ad066a34f2d7493aac88b3d386f0bbd4ea628018af4907fd9d45a58fea8aba343e"></a>satp_flag_auth_verify&#160;</td><td class="fielddoc"><p>The packet contains an authentication verify message </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4eab8fe0aa54700879bac861d7b564522ed" name="ad066a34f2d7493aac88b3d386f0bbd4eab8fe0aa54700879bac861d7b564522ed"></a>satp_flag_keepalive_request&#160;</td><td class="fielddoc"><p>The packet is a keep alive request </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4eaa741c190841ad6cf4a18d36f38c2a992" name="ad066a34f2d7493aac88b3d386f0bbd4eaa741c190841ad6cf4a18d36f38c2a992"></a>satp_flag_session_established&#160;</td><td class="fielddoc"><p>Indicates that the session has been established </p>
</td></tr>
<tr><td class="fieldname"><a id="ad066a34f2d7493aac88b3d386f0bbd4ea424f30de28eb65d70844f879e5e3b484" name="ad066a34f2d7493aac88b3d386f0bbd4ea424f30de28eb65d70844f879e5e3b484"></a>satp_flag_error_condition&#160;</td><td class="fielddoc"><p>Indicates that the connection experienced an error </p>
</td></tr>
</table>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a9b7fb21d98c6ca889a0053a2fb8e685c" name="a9b7fb21d98c6ca889a0053a2fb8e685c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7fb21d98c6ca889a0053a2fb8e685c">&#9670;&#160;</a></span>satp_connection_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_connection_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>          <td class="paramname"><span class="paramname"><em>err</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>notify</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the network connection between hosts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cns</td><td>A pointer to the connection state structure </td></tr>
    <tr><td class="paramname">err</td><td>The error message </td></tr>
    <tr><td class="paramname">notify</td><td>Notify the remote host connection is closing </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a730dc6b96a4fc8b9880552f02e74e1a6" name="a730dc6b96a4fc8b9880552f02e74e1a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a730dc6b96a4fc8b9880552f02e74e1a6">&#9670;&#160;</a></span>satp_connection_dispose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_connection_dispose </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the connection state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cns</td><td>A pointer to the connection state structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aadf6227ad6889be02b6321c23ed822f8" name="aadf6227ad6889be02b6321c23ed822f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadf6227ad6889be02b6321c23ed822f8">&#9670;&#160;</a></span>satp_decrypt_error_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> satp_decrypt_error_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt an error message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cns</td><td>A pointer to the SATP client state structure. </td></tr>
    <tr><td class="paramname">message</td><td>The serialized error packet.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a" title="The SATP error values. This enumeration defines the error codes returned by SATP functions.">satp_errors</a></code> indicating the error message. </dd></dl>

</div>
</div>
<a id="a99fbb5fb645a8da4665f1c7b3a8a2075" name="a99fbb5fb645a8da4665f1c7b3a8a2075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99fbb5fb645a8da4665f1c7b3a8a2075">&#9670;&#160;</a></span>satp_decrypt_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> satp_decrypt_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt an SATP packet. </p>
<p>This function decrypts the message contained in the input SATP network packet using the client's current decryption state, and copies the plaintext into the provided output buffer. The length of the decrypted message is returned via the msglen parameter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cns</td><td>A pointer to the SATP client state structure. </td></tr>
    <tr><td class="paramname">packetin</td><td>[const] A pointer to the input SATP network packet. </td></tr>
    <tr><td class="paramname">message</td><td>The output buffer where the decrypted message will be stored. </td></tr>
    <tr><td class="paramname">msglen</td><td>A pointer to a variable that receives the length of the decrypted message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a" title="The SATP error values. This enumeration defines the error codes returned by SATP functions.">satp_errors</a></code> indicating the result of the decryption operation. </dd></dl>

</div>
</div>
<a id="a1c4bab130e2a50f12a332e78c31dba37" name="a1c4bab130e2a50f12a332e78c31dba37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c4bab130e2a50f12a332e78c31dba37">&#9670;&#160;</a></span>satp_deserialize_device_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_deserialize_device_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__device__key.html">satp_device_key</a> *</td>          <td class="paramname"><span class="paramname"><em>dkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize a client device key. This function deserializes a byte array into a SATP device key structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dkey</td><td>The output SATP device key structure. </td></tr>
    <tr><td class="paramname">input</td><td>The input serialized device key array of size <code>SATP_DEVKEY_ENCODED_SIZE</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab1c0af0699f00c99b2922c5a0de00ccf" name="ab1c0af0699f00c99b2922c5a0de00ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1c0af0699f00c99b2922c5a0de00ccf">&#9670;&#160;</a></span>satp_deserialize_master_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_deserialize_master_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__master__key.html">satp_master_key</a> *</td>          <td class="paramname"><span class="paramname"><em>mkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize a master key from a byte array. This function deserializes a byte array into a SATP master key structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mkey</td><td>The output SATP master key structure. </td></tr>
    <tr><td class="paramname">input</td><td>The input serialized master key array of size <code>SATP_MSTKEY_ENCODED_SIZE</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7998cf2a551b7c4fcf6fbdfcf9ba6ec9" name="a7998cf2a551b7c4fcf6fbdfcf9ba6ec9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7998cf2a551b7c4fcf6fbdfcf9ba6ec9">&#9670;&#160;</a></span>satp_deserialize_server_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_deserialize_server_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__server__key.html">satp_server_key</a> *</td>          <td class="paramname"><span class="paramname"><em>skey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>input</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize a server key from a byte array. This function deserializes a byte array into a SATP server key structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skey</td><td>The output SATP server key structure. </td></tr>
    <tr><td class="paramname">input</td><td>The input serialized server key array of size <code>SATP_SRVKEY_ENCODED_SIZE</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0c056dd561cc1e3d59136fbf934dac12" name="a0c056dd561cc1e3d59136fbf934dac12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c056dd561cc1e3d59136fbf934dac12">&#9670;&#160;</a></span>satp_encrypt_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> satp_encrypt_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__connection__state.html">satp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>message</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetout</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a message into an SATP packet. </p>
<p>This function encrypts the provided plaintext message using the client's current transmit cipher state. It then constructs an SATP network packet containing the encrypted message along with the appropriate header fields (such as message length, sequence number, and UTC timestamp), and outputs the packet via the provided structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cns</td><td>A pointer to the SATP client state structure. </td></tr>
    <tr><td class="paramname">message</td><td>[const] The plaintext message to be encrypted. </td></tr>
    <tr><td class="paramname">msglen</td><td>The length of the plaintext message in bytes. </td></tr>
    <tr><td class="paramname">packetout</td><td>A pointer to the output SATP network packet structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a" title="The SATP error values. This enumeration defines the error codes returned by SATP functions.">satp_errors</a></code> indicating the success or failure of the encryption process. </dd></dl>

</div>
</div>
<a id="aee061dfbc12a598fb47393ee37288be5" name="aee061dfbc12a598fb47393ee37288be5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee061dfbc12a598fb47393ee37288be5">&#9670;&#160;</a></span>satp_error_to_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API const char * satp_error_to_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a string description of an SATP error code. This function returns a human-readable string corresponding to the provided SATP error code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">error</td><td>The SATP error code.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to the error description string, or NULL if the error code is not recognized. </dd></dl>

</div>
</div>
<a id="aaa2e0f35cac6e54840a8796077096bc0" name="aaa2e0f35cac6e54840a8796077096bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2e0f35cac6e54840a8796077096bc0">&#9670;&#160;</a></span>satp_extract_device_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API bool satp_extract_device_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>dk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>sk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>kid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract a device key. This function extracts a device key by hashing the server key and key identity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dk</td><td>The pointer to the output device key array. </td></tr>
    <tr><td class="paramname">sk</td><td>The input server derivation key. </td></tr>
    <tr><td class="paramname">kid</td><td>The key identity including client id and key counter. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a77c0d2627e573b0ab6392e020f2827fc" name="a77c0d2627e573b0ab6392e020f2827fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77c0d2627e573b0ab6392e020f2827fc">&#9670;&#160;</a></span>satp_generate_device_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_generate_device_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__device__key.html">satp_device_key</a> *</td>          <td class="paramname"><span class="paramname"><em>dkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsatp__server__key.html">satp_server_key</a> *</td>          <td class="paramname"><span class="paramname"><em>skey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>did</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a device key-set. This function generates a new SATP device key-set using the provided server key. It derives the device key from the server key and sets the key identity and expiration time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dkey</td><td>A pointer to the SATP device key structure. </td></tr>
    <tr><td class="paramname">skey</td><td>[const] A pointer to the SATP server key structure. </td></tr>
    <tr><td class="paramname">did</td><td>[const] The key identity string. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a281a41da487bc334fab7819ee9c02945" name="a281a41da487bc334fab7819ee9c02945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281a41da487bc334fab7819ee9c02945">&#9670;&#160;</a></span>satp_generate_master_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API bool satp_generate_master_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__master__key.html">satp_master_key</a> *</td>          <td class="paramname"><span class="paramname"><em>mkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>mid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a master key-set. This function generates a new SATP master key-set. It populates the provided master key structure with a randomly generated master derivation key and the key identity, and sets the expiration time. The master key serves as the root from which branch keys are derived. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mkey</td><td>A pointer to the SATP master key structure. </td></tr>
    <tr><td class="paramname">mid</td><td>[const] The master key identity.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns false if the random generator fails; otherwise, returns true. </dd></dl>

</div>
</div>
<a id="a59c530e1cf72b42b6f52771d9afecb15" name="a59c530e1cf72b42b6f52771d9afecb15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59c530e1cf72b42b6f52771d9afecb15">&#9670;&#160;</a></span>satp_generate_server_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API bool satp_generate_server_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__server__key.html">satp_server_key</a> *</td>          <td class="paramname"><span class="paramname"><em>skey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsatp__master__key.html">satp_master_key</a> *</td>          <td class="paramname"><span class="paramname"><em>mkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>sid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a server key-set. This function generates a new SATP server key-set based on the provided master key. It populates the server key structure with a derived server key and sets the key identity and expiration time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skey</td><td>A pointer to the SATP server key structure. </td></tr>
    <tr><td class="paramname">mkey</td><td>[const] A pointer to the SATP master key structure. </td></tr>
    <tr><td class="paramname">sid</td><td>[const] The key identity string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns false if the random generator fails; otherwise, returns true. </dd></dl>

</div>
</div>
<a id="a0cc1070b8e5286a63d637aa24bf1850c" name="a0cc1070b8e5286a63d637aa24bf1850c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc1070b8e5286a63d637aa24bf1850c">&#9670;&#160;</a></span>satp_increment_device_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_increment_device_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>sdkey</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increment the serialized key This function clears a key at the current position and increments the kid counter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sdkey</td><td>The input/output serialized SATP server key structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1f46c173b5fb7d35837a70403572a407" name="a1f46c173b5fb7d35837a70403572a407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f46c173b5fb7d35837a70403572a407">&#9670;&#160;</a></span>satp_packet_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_packet_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear a SATP network packet. This function resets the fields of a SATP network packet to zero, effectively clearing its state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet to clear. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3a799bd9ea26e386e6fead4a6b43ca64" name="a3a799bd9ea26e386e6fead4a6b43ca64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a799bd9ea26e386e6fead4a6b43ca64">&#9670;&#160;</a></span>satp_packet_error_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_packet_error_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Populate a packet structure with an error message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>A pointer to the packet structure </td></tr>
    <tr><td class="paramname">error</td><td>The error type </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acf0a09fd626ef1c139b89f0c1f3ba025" name="acf0a09fd626ef1c139b89f0c1f3ba025"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0a09fd626ef1c139b89f0c1f3ba025">&#9670;&#160;</a></span>satp_packet_header_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_packet_header_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetout</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a></td>          <td class="paramname"><span class="paramname"><em>flag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>sequence</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Populate a packet header and set the creation time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetout</td><td>A pointer to the output packet structure </td></tr>
    <tr><td class="paramname">flag</td><td>The packet flag </td></tr>
    <tr><td class="paramname">sequence</td><td>The packet sequence number </td></tr>
    <tr><td class="paramname">msglen</td><td>The length of the message array </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9e349323de91e572ec561f0178e65c80" name="a9e349323de91e572ec561f0178e65c80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e349323de91e572ec561f0178e65c80">&#9670;&#160;</a></span>satp_packet_header_deserialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_packet_header_deserialize </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>header</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize a byte array into a SATP packet header. This function converts a serialized byte array representing a SATP packet header into a structured SATP network packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>A pointer to the input header byte array. </td></tr>
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet structure to populate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4a2e702a3fc5f396d04d3e6154a99e7b" name="a4a2e702a3fc5f396d04d3e6154a99e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2e702a3fc5f396d04d3e6154a99e7b">&#9670;&#160;</a></span>satp_packet_header_serialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_packet_header_serialize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>header</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize a SATP packet header into a byte array. This function converts a structured SATP network packet header into a serialized byte array for transmission. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet structure to serialize. </td></tr>
    <tr><td class="paramname">header</td><td>The output header byte array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0b08296d5bd696384523cdf09a228b6b" name="a0b08296d5bd696384523cdf09a228b6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b08296d5bd696384523cdf09a228b6b">&#9670;&#160;</a></span>satp_packet_header_validate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API <a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a> satp_packet_header_validate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packetin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad066a34f2d7493aac88b3d386f0bbd4e">satp_flags</a></td>          <td class="paramname"><span class="paramname"><em>pktflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t</td>          <td class="paramname"><span class="paramname"><em>sequence</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>msglen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a packet header and timestamp. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packetin</td><td>A pointer to the input packet structure </td></tr>
    <tr><td class="paramname">pktflag</td><td>The packet flag </td></tr>
    <tr><td class="paramname">sequence</td><td>The packet sequence number </td></tr>
    <tr><td class="paramname">msglen</td><td>The length of the message array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: Returns the function error state </dd></dl>

</div>
</div>
<a id="affba3463edb0696a2478b3c488292cae" name="affba3463edb0696a2478b3c488292cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affba3463edb0696a2478b3c488292cae">&#9670;&#160;</a></span>satp_packet_set_utc_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_packet_set_utc_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the local UTC seconds time in a SATP packet header. This function updates the SATP packet header with the current UTC time (in seconds). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2d7472a57310d89dea3fe523071cf3cc" name="a2d7472a57310d89dea3fe523071cf3cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d7472a57310d89dea3fe523071cf3cc">&#9670;&#160;</a></span>satp_packet_time_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API bool satp_packet_time_valid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a SATP packet is received within the valid time threshold. This function compares the UTC time in the SATP packet header against the local time to verify that the packet was received within the allowed time threshold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the packet was received within the valid time threshold; otherwise, returns false. </dd></dl>

</div>
</div>
<a id="a397497c605ec6309d2bf676596037f40" name="a397497c605ec6309d2bf676596037f40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a397497c605ec6309d2bf676596037f40">&#9670;&#160;</a></span>satp_packet_to_stream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API size_t satp_packet_to_stream </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>pstream</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize a SATP packet into a byte array. This function converts a SATP network packet into a contiguous byte stream suitable for network transmission. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet structure. </td></tr>
    <tr><td class="paramname">pstream</td><td>The output byte stream buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the size (in bytes) of the serialized packet. </dd></dl>

</div>
</div>
<a id="a1bd090965292a0a9e373b26751a9bbe2" name="a1bd090965292a0a9e373b26751a9bbe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd090965292a0a9e373b26751a9bbe2">&#9670;&#160;</a></span>satp_send_network_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_send_network_error </td>
          <td>(</td>
          <td class="paramtype">const qsc_socket *</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ad018e7d955cb389223bcc7e5d8a38c5a">satp_errors</a></td>          <td class="paramname"><span class="paramname"><em>error</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a plaintext SATP network error message Used only during key exchange, the connection close is sent over an encrypted tunnel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sock</td><td>A pointer to the SATP network packet structure. </td></tr>
    <tr><td class="paramname">error</td><td>The output byte stream buffer. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a48d598ef3325f5fbe95a3ed88a017088" name="a48d598ef3325f5fbe95a3ed88a017088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48d598ef3325f5fbe95a3ed88a017088">&#9670;&#160;</a></span>satp_serialize_device_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_serialize_device_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsatp__device__key.html">satp_device_key</a> *</td>          <td class="paramname"><span class="paramname"><em>dkey</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize a client device key. This function serializes a SATP device key structure into a byte array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>The output byte array to hold the serialized device key. </td></tr>
    <tr><td class="paramname">dkey</td><td>The input SATP device key structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae99fd2e7baae45f495dc6233320362cf" name="ae99fd2e7baae45f495dc6233320362cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae99fd2e7baae45f495dc6233320362cf">&#9670;&#160;</a></span>satp_serialize_master_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_serialize_master_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsatp__master__key.html">satp_master_key</a> *</td>          <td class="paramname"><span class="paramname"><em>mkey</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize a master key into a byte array. This function serializes a SATP master key structure into a byte array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>The output byte array to hold the serialized master key. </td></tr>
    <tr><td class="paramname">mkey</td><td>The input SATP master key structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a47a1c8f31535ac24db7aa5aa6baf9817" name="a47a1c8f31535ac24db7aa5aa6baf9817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a1c8f31535ac24db7aa5aa6baf9817">&#9670;&#160;</a></span>satp_serialize_server_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_serialize_server_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsatp__server__key.html">satp_server_key</a> *</td>          <td class="paramname"><span class="paramname"><em>skey</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serialize a server key into a byte array. This function serializes a SATP server key structure into a byte array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>The output byte array to hold the serialized server key. </td></tr>
    <tr><td class="paramname">skey</td><td>The input SATP server key structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a87ff5101cfbe562d11ae3acab708d638" name="a87ff5101cfbe562d11ae3acab708d638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87ff5101cfbe562d11ae3acab708d638">&#9670;&#160;</a></span>satp_stream_to_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SATP_EXPORT_API void satp_stream_to_packet </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>pstream</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsatp__network__packet.html">satp_network_packet</a> *</td>          <td class="paramname"><span class="paramname"><em>packet</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deserialize a byte stream into a SATP network packet. This function converts a contiguous byte stream into a structured SATP network packet. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pstream</td><td>A pointer to the input byte stream. </td></tr>
    <tr><td class="paramname">packet</td><td>A pointer to the SATP network packet structure to populate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_e669f2dbe370c85fafb6565895d91f2e.html">SATP</a></li><li class="navelem"><a href="satp_8h.html">satp.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
