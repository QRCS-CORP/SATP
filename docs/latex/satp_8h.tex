\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+SATP/\+SATP/satp.h File Reference}
\hypertarget{satp_8h}{}\label{satp_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/SATP/SATP/satp.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/SATP/SATP/satp.h}}


SATP support header Common defined parameters and functions of the SATP client and server implementations.  


{\ttfamily \#include "{}satpcommon.\+h"{}}\newline
{\ttfamily \#include "{}sha3.\+h"{}}\newline
{\ttfamily \#include "{}socket.\+h"{}}\newline
{\ttfamily \#include "{}socketclient.\+h"{}}\newline
{\ttfamily \#include "{}rcs.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The SATP socket connection state structure. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}}
\begin{DoxyCompactList}\small\item\em The SATP device key structure. This structure represents the SATP device key, which is derived from the server key. It includes the device key identity, device derivation key, and an expiration time. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}}
\begin{DoxyCompactList}\small\item\em The SATP master key structure. This structure holds the SATP master key information, including the key identity, the master derivation key, and the expiration time. The master key is used as the root from which branch keys are derived. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}}
\begin{DoxyCompactList}\small\item\em The SATP server key structure. This structure represents the SATP server key, which is derived from the master key. It contains the server\textquotesingle{}s key identity, server derivation key, and expiration time. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structqsmp__keep__alive__state}{qsmp\+\_\+keep\+\_\+alive\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The SATP keep alive state structure. This structure tracks the state of keep alive messages within SATP. It includes the epoch time when the last keep alive message was sent, a packet sequence counter, and a flag indicating whether a response has been received. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}}
\begin{DoxyCompactList}\small\item\em The SATP network packet structure. This structure defines the format of a SATP network packet. It includes a packet flag, the message length, a sequence number, a UTC timestamp for packet creation, and a pointer to the message data. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{satp_8h_a3781926192a613e59225b259cef1f28c}\label{satp_8h_a3781926192a613e59225b259cef1f28c} 
\#define {\bfseries SATP\+\_\+\+USE\+\_\+\+RCS\+\_\+\+ENCRYPTION}
\begin{DoxyCompactList}\small\item\em If the RCS encryption option is chosen SATP uses the more modern RCS stream cipher with KMAC/\+QMAC authentication. The default symmetric cipher/authenticator is AES-\/256/\+GCM (GMAC Counter Mode) NIST standardized per SP800-\/38a. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a457c27c4a5da2abedd6db378a2e4355a}\label{satp_8h_a457c27c4a5da2abedd6db378a2e4355a} 
\#define {\bfseries satp\+\_\+cipher\+\_\+state}~qsc\+\_\+rcs\+\_\+state
\item 
\Hypertarget{satp_8h_adb450d725f0e9a93d017c740f5d3def7}\label{satp_8h_adb450d725f0e9a93d017c740f5d3def7} 
\#define {\bfseries satp\+\_\+cipher\+\_\+dispose}~qsc\+\_\+rcs\+\_\+dispose
\item 
\Hypertarget{satp_8h_a52720e84105a014c432f25a138ce48c8}\label{satp_8h_a52720e84105a014c432f25a138ce48c8} 
\#define {\bfseries satp\+\_\+cipher\+\_\+initialize}~qsc\+\_\+rcs\+\_\+initialize
\item 
\Hypertarget{satp_8h_ae5a79afc10899d0deac95fec66966e55}\label{satp_8h_ae5a79afc10899d0deac95fec66966e55} 
\#define {\bfseries satp\+\_\+cipher\+\_\+keyparams}~qsc\+\_\+rcs\+\_\+keyparams
\item 
\Hypertarget{satp_8h_afc110de1909f1359f029c2a3843003b2}\label{satp_8h_afc110de1909f1359f029c2a3843003b2} 
\#define {\bfseries satp\+\_\+cipher\+\_\+set\+\_\+associated}~qsc\+\_\+rcs\+\_\+set\+\_\+associated
\item 
\Hypertarget{satp_8h_a2678bd82012a6a293436e27c98de4836}\label{satp_8h_a2678bd82012a6a293436e27c98de4836} 
\#define {\bfseries satp\+\_\+cipher\+\_\+transform}~qsc\+\_\+rcs\+\_\+transform
\item 
\Hypertarget{satp_8h_a20277709f9afb30843128daeb632c580}\label{satp_8h_a20277709f9afb30843128daeb632c580} 
\#define {\bfseries SATP\+\_\+\+CLIENT\+\_\+\+PASSWORD\+\_\+\+MAX}~256U
\begin{DoxyCompactList}\small\item\em The client passphrase maximum string length. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_af58a2c206f8952d8013414a41c2b3ce4}\label{satp_8h_af58a2c206f8952d8013414a41c2b3ce4} 
\#define {\bfseries SATP\+\_\+\+CLIENT\+\_\+\+USERNAME\+\_\+\+MAX}~256U
\begin{DoxyCompactList}\small\item\em The client username maximum string length. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a8ef1b32919e3f230c9a4849245fdd2da}\label{satp_8h_a8ef1b32919e3f230c9a4849245fdd2da} 
\#define {\bfseries SATP\+\_\+\+CONNECTIONS\+\_\+\+INIT}~1000U
\begin{DoxyCompactList}\small\item\em The intitial SATP connections queue size. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a41bde198c9b551c0cd16b32297617153}\label{satp_8h_a41bde198c9b551c0cd16b32297617153} 
\#define {\bfseries SATP\+\_\+\+CONNECTIONS\+\_\+\+MAX}~50000U
\begin{DoxyCompactList}\small\item\em The maximum number of connections. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_afea8720f234f62f4a19f6d951b54d58d}\label{satp_8h_afea8720f234f62f4a19f6d951b54d58d} 
\#define {\bfseries SATP\+\_\+\+CONFIG\+\_\+\+SIZE}~25U
\begin{DoxyCompactList}\small\item\em The size of the protocol configuration string. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a158f1fc90b6636c22f098d9e97f996f4}\label{satp_8h_a158f1fc90b6636c22f098d9e97f996f4} 
\#define {\bfseries SATP\+\_\+\+ERROR\+\_\+\+SIZE}~1U
\begin{DoxyCompactList}\small\item\em The size of a system error message. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a7f6579e0efba42857a914de8b486840d}\label{satp_8h_a7f6579e0efba42857a914de8b486840d} 
\#define {\bfseries SATP\+\_\+\+EXPIRATION\+\_\+\+SIZE}~8U
\begin{DoxyCompactList}\small\item\em The size (in bytes) of the expiration field. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a2ccf5e1b5e2c43f7295979b7828377e6}\label{satp_8h_a2ccf5e1b5e2c43f7295979b7828377e6} 
\#define {\bfseries SATP\+\_\+\+HASH\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The SATP hash size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a2ffb5a23ee8a36fcec7cf65d6a3e2e15}\label{satp_8h_a2ffb5a23ee8a36fcec7cf65d6a3e2e15} 
\#define {\bfseries SATP\+\_\+\+HEADER\+\_\+\+SIZE}~21U
\begin{DoxyCompactList}\small\item\em The SATP packet header size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_afd1613bbf06416e196a4c524ac476c82}\label{satp_8h_afd1613bbf06416e196a4c524ac476c82} 
\#define {\bfseries SATP\+\_\+\+KEEPALIVE\+\_\+\+MESSAGE}~8U
\begin{DoxyCompactList}\small\item\em The size (in bytes) of the keep alive integer message. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a12dbd80e799088d3020722cc833934fd}\label{satp_8h_a12dbd80e799088d3020722cc833934fd} 
\#define {\bfseries SATP\+\_\+\+KEEPALIVE\+\_\+\+STRING}~20U
\begin{DoxyCompactList}\small\item\em The keep alive string size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_ab0db46c9761c14886afce69e1fccf042}\label{satp_8h_ab0db46c9761c14886afce69e1fccf042} 
\#define {\bfseries SATP\+\_\+\+KEEPALIVE\+\_\+\+TIMEOUT}~(300U \texorpdfstring{$\ast$}{*} 1000U)
\begin{DoxyCompactList}\small\item\em The keep alive timeout in milliseconds (5 minutes). \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a7f8c8dfaa8d1d7099820c1ccef5b2672}\label{satp_8h_a7f8c8dfaa8d1d7099820c1ccef5b2672} 
\#define {\bfseries SATP\+\_\+\+KEY\+\_\+\+TREE\+\_\+\+COUNT}~1024
\begin{DoxyCompactList}\small\item\em The SATP key tree count. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a6b855b04abe2e1fe4eea111afeb78b16}\label{satp_8h_a6b855b04abe2e1fe4eea111afeb78b16} 
\#define {\bfseries SATP\+\_\+\+MACTAG\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The SATP configuration string for 256-\/bit security. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a312ddf5a9842749b119212e88c4202be}\label{satp_8h_a312ddf5a9842749b119212e88c4202be} 
\#define {\bfseries SATP\+\_\+\+MESSAGE\+\_\+\+SIZE}~1024U
\begin{DoxyCompactList}\small\item\em The message size (in bytes) used during a communications session. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a0a1241ef7137bd33fc9f39a00adb35bd}\label{satp_8h_a0a1241ef7137bd33fc9f39a00adb35bd} 
\#define {\bfseries SATP\+\_\+\+MESSAGE\+\_\+\+MAX}~(\mbox{\hyperlink{satp_8h_a312ddf5a9842749b119212e88c4202be}{SATP\+\_\+\+MESSAGE\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a2ffb5a23ee8a36fcec7cf65d6a3e2e15}{SATP\+\_\+\+HEADER\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em The maximum message size in bytes (may exceed MTU). \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_addc804fd519c7e81d7f66dbcb7907b8c}\label{satp_8h_addc804fd519c7e81d7f66dbcb7907b8c} 
\#define {\bfseries SATP\+\_\+\+CONNECTION\+\_\+\+MTU}~1500U
\begin{DoxyCompactList}\small\item\em The SATP packet buffer size. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_aa87e9423e91b8fd1a0b98bac45755a87}\label{satp_8h_aa87e9423e91b8fd1a0b98bac45755a87} 
\#define {\bfseries SATP\+\_\+\+NONCE\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The nonce size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_abd6e04bbc39dffe4395782d752919e40}\label{satp_8h_abd6e04bbc39dffe4395782d752919e40} 
\#define {\bfseries SATP\+\_\+\+SALT\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The SATP salt size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_aad5afd72918b2d0dc3f7078fa583c8fb}\label{satp_8h_aad5afd72918b2d0dc3f7078fa583c8fb} 
\#define {\bfseries SATP\+\_\+\+SERVER\+\_\+\+PORT}~2701U
\begin{DoxyCompactList}\small\item\em The default SATP server port number. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a7abe2545d495b62d9157c24dbfaeceea}\label{satp_8h_a7abe2545d495b62d9157c24dbfaeceea} 
\#define {\bfseries SATP\+\_\+\+SEQUENCE\+\_\+\+TERMINATOR}~0x\+FFFFFFFFUL
\begin{DoxyCompactList}\small\item\em The sequence number of a packet that closes a connection. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_acfb75d3ded818ff81dd13465dcdd7976}\label{satp_8h_acfb75d3ded818ff81dd13465dcdd7976} 
\#define {\bfseries SATP\+\_\+\+KEY\+\_\+\+DURATION\+\_\+\+DAYS}~365U
\begin{DoxyCompactList}\small\item\em The number of days a key remains valid. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{satp_8h_ab85d8ae0229ca75b7de3d1e3f149efd2}{SATP\+\_\+\+PACKET\+\_\+\+TIME\+\_\+\+THRESHOLD}}~60U
\begin{DoxyCompactList}\small\item\em The maximum number of seconds a packet is considered valid. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a944a93b35a802789b7f05b069de1e68b}\label{satp_8h_a944a93b35a802789b7f05b069de1e68b} 
\#define {\bfseries SATP\+\_\+\+KEY\+\_\+\+DURATION\+\_\+\+SECONDS}~(\mbox{\hyperlink{satp_8h_acfb75d3ded818ff81dd13465dcdd7976}{SATP\+\_\+\+KEY\+\_\+\+DURATION\+\_\+\+DAYS}} \texorpdfstring{$\ast$}{*} 24U \texorpdfstring{$\ast$}{*} 60U \texorpdfstring{$\ast$}{*} 60U)
\begin{DoxyCompactList}\small\item\em The number of seconds a key remains valid. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_af18b2ae7978d8481be0d83a0f83dde9d}\label{satp_8h_af18b2ae7978d8481be0d83a0f83dde9d} 
\#define {\bfseries SATP\+\_\+\+BRANCH\+\_\+\+ID\+\_\+\+SIZE}~2U
\begin{DoxyCompactList}\small\item\em Branch ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_abc4ba90f4d749d5ebb8021871b677a43}\label{satp_8h_abc4ba90f4d749d5ebb8021871b677a43} 
\#define {\bfseries SATP\+\_\+\+DOMAIN\+\_\+\+ID\+\_\+\+SIZE}~2U
\begin{DoxyCompactList}\small\item\em Domain (Master) ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_ababa3b4f9709484fb79448c6541308de}\label{satp_8h_ababa3b4f9709484fb79448c6541308de} 
\#define {\bfseries SATP\+\_\+\+DEVICE\+\_\+\+ID\+\_\+\+SIZE}~4U
\begin{DoxyCompactList}\small\item\em Device ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a9880cc763010b2952af9539d078195a0}\label{satp_8h_a9880cc763010b2952af9539d078195a0} 
\#define {\bfseries SATP\+\_\+\+EPOCH\+\_\+\+SIZE}~2U
\begin{DoxyCompactList}\small\item\em Epoch class size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_afebb1e80c8b1c6b8c02734c62c03aa7e}\label{satp_8h_afebb1e80c8b1c6b8c02734c62c03aa7e} 
\#define {\bfseries SATP\+\_\+\+ERROR\+\_\+\+MESSAGE\+\_\+\+SIZE}~1U
\begin{DoxyCompactList}\small\item\em The packet error message size. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a982ab31e19241f4e094aad24f13221ce}\label{satp_8h_a982ab31e19241f4e094aad24f13221ce} 
\#define {\bfseries SATP\+\_\+\+ERROR\+\_\+\+SEQUENCE}~0x\+FF00000000000000\+ULL
\begin{DoxyCompactList}\small\item\em The packet error sequence number. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a34327b08780546d7b10b3f56970a74dd}\label{satp_8h_a34327b08780546d7b10b3f56970a74dd} 
\#define {\bfseries SATP\+\_\+\+FLAG\+\_\+\+SIZE}~1
\begin{DoxyCompactList}\small\item\em The packet flag size. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a3f5aef3527e346132099a2a5a78dc16c}\label{satp_8h_a3f5aef3527e346132099a2a5a78dc16c} 
\#define {\bfseries SATP\+\_\+\+KEY\+\_\+\+ID\+\_\+\+SIZE}~4U
\begin{DoxyCompactList}\small\item\em Key ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a4a9274ad4f2c83c0315b0e88180fb478}\label{satp_8h_a4a9274ad4f2c83c0315b0e88180fb478} 
\#define {\bfseries SATP\+\_\+\+SERVICE\+\_\+\+ID\+\_\+\+SIZE}~2U
\begin{DoxyCompactList}\small\item\em Service ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a4befa8797a1f336c6a5d4bef31f4ef0d}\label{satp_8h_a4befa8797a1f336c6a5d4bef31f4ef0d} 
\#define {\bfseries SATP\+\_\+\+DID\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_abc4ba90f4d749d5ebb8021871b677a43}{SATP\+\_\+\+DOMAIN\+\_\+\+ID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_af18b2ae7978d8481be0d83a0f83dde9d}{SATP\+\_\+\+BRANCH\+\_\+\+ID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a9880cc763010b2952af9539d078195a0}{SATP\+\_\+\+EPOCH\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a4a9274ad4f2c83c0315b0e88180fb478}{SATP\+\_\+\+SERVICE\+\_\+\+ID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_ababa3b4f9709484fb79448c6541308de}{SATP\+\_\+\+DEVICE\+\_\+\+ID\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em The full sub-\/key ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_afad2aa0a7009769010e4fbd5b3229ae2}\label{satp_8h_afad2aa0a7009769010e4fbd5b3229ae2} 
\#define {\bfseries SATP\+\_\+\+MID\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_abc4ba90f4d749d5ebb8021871b677a43}{SATP\+\_\+\+DOMAIN\+\_\+\+ID\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em The master key identity size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a16b831ff71e2d15a824a890f542e24f0}\label{satp_8h_a16b831ff71e2d15a824a890f542e24f0} 
\#define {\bfseries SATP\+\_\+\+SID\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_abc4ba90f4d749d5ebb8021871b677a43}{SATP\+\_\+\+DOMAIN\+\_\+\+ID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_af18b2ae7978d8481be0d83a0f83dde9d}{SATP\+\_\+\+BRANCH\+\_\+\+ID\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em The server ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a92dfd14570beaf5e896495405760777b}\label{satp_8h_a92dfd14570beaf5e896495405760777b} 
\#define {\bfseries SATP\+\_\+\+KID\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_a4befa8797a1f336c6a5d4bef31f4ef0d}{SATP\+\_\+\+DID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a3f5aef3527e346132099a2a5a78dc16c}{SATP\+\_\+\+KEY\+\_\+\+ID\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em The key ID size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a21645295558e27eed64fc61b87116747}\label{satp_8h_a21645295558e27eed64fc61b87116747} 
\#define {\bfseries SATP\+\_\+\+DKEY\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The client key size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a8ff169084319c479c3a8e01addeb3098}\label{satp_8h_a8ff169084319c479c3a8e01addeb3098} 
\#define {\bfseries SATP\+\_\+\+MKEY\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The master key size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_ab89af91e1cfc71dfbb93aac6d33dd2f3}\label{satp_8h_ab89af91e1cfc71dfbb93aac6d33dd2f3} 
\#define {\bfseries SATP\+\_\+\+SKEY\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The server key size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a3e297e70dd87c4d8b4c707e70e9d81c5}\label{satp_8h_a3e297e70dd87c4d8b4c707e70e9d81c5} 
\#define {\bfseries SATP\+\_\+\+KTREE\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_a21645295558e27eed64fc61b87116747}{SATP\+\_\+\+DKEY\+\_\+\+SIZE}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{satp_8h_a7f8c8dfaa8d1d7099820c1ccef5b2672}{SATP\+\_\+\+KEY\+\_\+\+TREE\+\_\+\+COUNT}})
\begin{DoxyCompactList}\small\item\em The key tree size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a35a9df3a6f8f338d79d2dc6ffe9c2967}\label{satp_8h_a35a9df3a6f8f338d79d2dc6ffe9c2967} 
\#define {\bfseries SATP\+\_\+\+DKEY\+\_\+\+ENCODED\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_a92dfd14570beaf5e896495405760777b}{SATP\+\_\+\+KID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_ab89af91e1cfc71dfbb93aac6d33dd2f3}{SATP\+\_\+\+SKEY\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a7f6579e0efba42857a914de8b486840d}{SATP\+\_\+\+EXPIRATION\+\_\+\+SIZE}} + (\mbox{\hyperlink{satp_8h_a21645295558e27eed64fc61b87116747}{SATP\+\_\+\+DKEY\+\_\+\+SIZE}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{satp_8h_a7f8c8dfaa8d1d7099820c1ccef5b2672}{SATP\+\_\+\+KEY\+\_\+\+TREE\+\_\+\+COUNT}}))
\begin{DoxyCompactList}\small\item\em The serialized device key size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_a8001eefe732bf05985c027bee597c8c4}\label{satp_8h_a8001eefe732bf05985c027bee597c8c4} 
\#define {\bfseries SATP\+\_\+\+MKEY\+\_\+\+ENCODED\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_a8ff169084319c479c3a8e01addeb3098}{SATP\+\_\+\+MKEY\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_afad2aa0a7009769010e4fbd5b3229ae2}{SATP\+\_\+\+MID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a7f6579e0efba42857a914de8b486840d}{SATP\+\_\+\+EXPIRATION\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em serialized master key size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_ad603ccba31d8103fa9da82478d822933}\label{satp_8h_ad603ccba31d8103fa9da82478d822933} 
\#define {\bfseries SATP\+\_\+\+SKEY\+\_\+\+ENCODED\+\_\+\+SIZE}~(\mbox{\hyperlink{satp_8h_ab89af91e1cfc71dfbb93aac6d33dd2f3}{SATP\+\_\+\+SKEY\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_ab89af91e1cfc71dfbb93aac6d33dd2f3}{SATP\+\_\+\+SKEY\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a16b831ff71e2d15a824a890f542e24f0}{SATP\+\_\+\+SID\+\_\+\+SIZE}} + \mbox{\hyperlink{satp_8h_a7f6579e0efba42857a914de8b486840d}{SATP\+\_\+\+EXPIRATION\+\_\+\+SIZE}})
\begin{DoxyCompactList}\small\item\em serialized server key size in bytes. \end{DoxyCompactList}\item 
\Hypertarget{satp_8h_ae4de8c9d946143beaa6eea71bebbd513}\label{satp_8h_ae4de8c9d946143beaa6eea71bebbd513} 
\#define {\bfseries SATP\+\_\+\+STOK\+\_\+\+SIZE}~32U
\begin{DoxyCompactList}\small\item\em The session token size in bytes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{satp_8h_a1c373c84a5d65b6e1d6892b9324ac500}\label{satp_8h_a1c373c84a5d65b6e1d6892b9324ac500} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API enum \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} {\bfseries satp\+\_\+errors}
\item 
\Hypertarget{satp_8h_a0778ec80548c30cdba3266e6222277f9}\label{satp_8h_a0778ec80548c30cdba3266e6222277f9} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API enum \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}} {\bfseries satp\+\_\+flags}
\item 
\Hypertarget{satp_8h_afc7fd970fda3e336b103a5b87c6fc0f5}\label{satp_8h_afc7fd970fda3e336b103a5b87c6fc0f5} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API struct satp\+\_\+connection\+\_\+state {\bfseries satp\+\_\+connection\+\_\+state}
\item 
\Hypertarget{satp_8h_af54231a15be201f57ea8f7386a71de81}\label{satp_8h_af54231a15be201f57ea8f7386a71de81} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API struct satp\+\_\+device\+\_\+key {\bfseries satp\+\_\+device\+\_\+key}
\item 
\Hypertarget{satp_8h_a849fd59f2cd02c096fb89ea02b1ad9d9}\label{satp_8h_a849fd59f2cd02c096fb89ea02b1ad9d9} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API struct satp\+\_\+master\+\_\+key {\bfseries satp\+\_\+master\+\_\+key}
\item 
\Hypertarget{satp_8h_a0159f37c586d7b3f90fb10ca0ff8e023}\label{satp_8h_a0159f37c586d7b3f90fb10ca0ff8e023} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API struct satp\+\_\+server\+\_\+key {\bfseries satp\+\_\+server\+\_\+key}
\item 
\Hypertarget{satp_8h_a88c94728bbd992eaebb30a3be400ef44}\label{satp_8h_a88c94728bbd992eaebb30a3be400ef44} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API struct \mbox{\hyperlink{structqsmp__keep__alive__state}{qsmp\+\_\+keep\+\_\+alive\+\_\+state}} {\bfseries satp\+\_\+keep\+\_\+alive\+\_\+state}
\item 
\Hypertarget{satp_8h_abef6fd356e8c888895885215561dda05}\label{satp_8h_abef6fd356e8c888895885215561dda05} 
typedef SATP\+\_\+\+EXPORT\+\_\+\+API struct satp\+\_\+network\+\_\+packet {\bfseries satp\+\_\+network\+\_\+packet}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} \{ \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae0bd1ffa173ecefde1602fc4312b82d2}{satp\+\_\+error\+\_\+none}} = 0x00U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae9ed7692ea5ebb387f5ad7ab551675ec}{satp\+\_\+error\+\_\+accept\+\_\+fail}} = 0x01
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa201ca1ee4a2d2a7b46ca15ce60c70c73}{satp\+\_\+error\+\_\+authentication\+\_\+failure}} = 0x02U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae319c9039652d5dc7fdeece9e2c0323b}{satp\+\_\+error\+\_\+authentication\+\_\+success}} = 0x03U
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa298d0eeaed1477349c6e03d5ed535c0d}{satp\+\_\+erroe\+\_\+listen\+\_\+fail}} = 0x04U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa4b0c8f20e3212dd1a32cfd4c6f5dabb8}{satp\+\_\+error\+\_\+allocation\+\_\+failure}} = 0x05U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa5b4dd0b9aac0f5da5a393c67ea3212fd}{satp\+\_\+error\+\_\+bad\+\_\+keep\+\_\+alive}} = 0x06U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa9c818a084e31c65dac8a64ecd3561b77}{satp\+\_\+error\+\_\+cipher\+\_\+auth\+\_\+failure}} = 0x07U
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aac82788262b7d94d77cd96448c2c1046f}{satp\+\_\+error\+\_\+channel\+\_\+down}} = 0x08U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aab067e0737d6e3ddeb948937fc2f2a20a}{satp\+\_\+error\+\_\+connection\+\_\+failure}} = 0x09U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa6773dd68788a41abaafad2626fc66f36}{satp\+\_\+error\+\_\+decryption\+\_\+failure}} = 0x0\+AU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf54201a835177b6e645071eef3f4690f}{satp\+\_\+error\+\_\+device\+\_\+unrecognized}} = 0x0\+BU
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa904e1e37972dd8d5b6ef11c822183c16}{satp\+\_\+error\+\_\+establish\+\_\+failure}} = 0x0\+CU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa7c1510995d45f8ac5efad74764eb6947}{satp\+\_\+error\+\_\+hosts\+\_\+exceeded}} = 0x0\+DU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0f36a9a467bca90f55dcf574505315cd}{satp\+\_\+error\+\_\+invalid\+\_\+input}} = 0x0\+EU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa9de012221558389cfcba4f20471d53fe}{satp\+\_\+error\+\_\+invalid\+\_\+request}} = 0x0\+FU
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa8f1b47365c31d684ae30eb80622d3282}{satp\+\_\+error\+\_\+keep\+\_\+alive\+\_\+expired}} = 0x10U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa2c6e1ff643be3df77b13edcffe9d6f87}{satp\+\_\+error\+\_\+kex\+\_\+auth\+\_\+failure}} = 0x11U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa95c284acdbb9926ffa35f11d1b26a809}{satp\+\_\+error\+\_\+key\+\_\+expired}} = 0x12U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa7c9daf25b67b3467154d82da7c4a184d}{satp\+\_\+error\+\_\+key\+\_\+not\+\_\+recognized}} = 0x13U
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa5b3b79d832d4124935169bf67be1cbf7}{satp\+\_\+error\+\_\+listener\+\_\+fail}} = 0x14U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf59560eee974a0abb7ae8bc1a7b7001e}{satp\+\_\+error\+\_\+message\+\_\+time\+\_\+invalid}} = 0x15U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa8217e9c14802c70fdf7800a4bd784c12}{satp\+\_\+error\+\_\+packet\+\_\+expired}} = 0x16U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa846f1642f543dd051d40db797f5039db}{satp\+\_\+error\+\_\+packet\+\_\+unsequenced}} = 0x17U
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0d95f0095b9015fcc63c557957a678f6}{satp\+\_\+error\+\_\+random\+\_\+failure}} = 0x18U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf978ec059e4a360e2d2f3e1e12b79618}{satp\+\_\+error\+\_\+receive\+\_\+failure}} = 0x19U
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aac827f214b70ab0a2a415bd6004418da0}{satp\+\_\+error\+\_\+transmit\+\_\+failure}} = 0x1\+AU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0a53f61ddd8c8dd1aab552a7e72a746e}{satp\+\_\+error\+\_\+unknown\+\_\+protocol}} = 0x1\+BU
, \newline
\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae4ae8e656692a07a8c36a38ebf16dfac}{satp\+\_\+error\+\_\+unsequenced}} = 0x1\+CU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaef9010303da834586eb63e71664f6962}{satp\+\_\+error\+\_\+verify\+\_\+failure}} = 0x1\+DU
, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa3d706ae2143988c8e1cdbf31703589da}{satp\+\_\+error\+\_\+general\+\_\+failure}} = 0x\+FFU
 \}
\begin{DoxyCompactList}\small\item\em The SATP error values. This enumeration defines the error codes returned by SATP functions. \end{DoxyCompactList}\item 
enum \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}} \{ \newline
\mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea28bca8366091302d8ea83fbcb27c8414}{satp\+\_\+flag\+\_\+none}} = 0x00U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eac589dc859e24be990d2f883382dbb8ec}{satp\+\_\+flag\+\_\+connect\+\_\+request}} = 0x01U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea4734a78ed94a982901291eb6da46f093}{satp\+\_\+flag\+\_\+connect\+\_\+response}} = 0x02U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea28b787cd4b0990423d6287ff7e7e023b}{satp\+\_\+flag\+\_\+connection\+\_\+terminate}} = 0x03U
, \newline
\mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea8788180430fed49cc83a6f558322194b}{satp\+\_\+flag\+\_\+encrypted\+\_\+message}} = 0x04U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea5ccea056fdb79fcfaea6e21307348e17}{satp\+\_\+flag\+\_\+authentication\+\_\+request}} = 0x05U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea54b0410100520e2009f636c639ec2fc5}{satp\+\_\+flag\+\_\+authentication\+\_\+response}} = 0x06U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea628018af4907fd9d45a58fea8aba343e}{satp\+\_\+flag\+\_\+auth\+\_\+verify}} = 0x08U
, \newline
\mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eab8fe0aa54700879bac861d7b564522ed}{satp\+\_\+flag\+\_\+keepalive\+\_\+request}} = 0x09U
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eaa741c190841ad6cf4a18d36f38c2a992}{satp\+\_\+flag\+\_\+session\+\_\+established}} = 0x0\+AU
, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea424f30de28eb65d70844f879e5e3b484}{satp\+\_\+flag\+\_\+error\+\_\+condition}} = 0x\+FFU
 \}
\begin{DoxyCompactList}\small\item\em The SATP packet flag values. This enumeration defines the flag values used in SATP packets to indicate the type and purpose of the packet. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a9b7fb21d98c6ca889a0053a2fb8e685c}{satp\+\_\+connection\+\_\+close}} (\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} err, bool notify)
\begin{DoxyCompactList}\small\item\em Close the network connection between hosts. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a730dc6b96a4fc8b9880552f02e74e1a6}{satp\+\_\+connection\+\_\+dispose}} (\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Reset the connection state. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} \mbox{\hyperlink{satp_8h_aadf6227ad6889be02b6321c23ed822f8}{satp\+\_\+decrypt\+\_\+error\+\_\+message}} (\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns, uint8\+\_\+t \texorpdfstring{$\ast$}{*}message)
\begin{DoxyCompactList}\small\item\em Decrypt an error message. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} \mbox{\hyperlink{satp_8h_a99fbb5fb645a8da4665f1c7b3a8a2075}{satp\+\_\+decrypt\+\_\+packet}} (\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns, const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packetin, uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t \texorpdfstring{$\ast$}{*}msglen)
\begin{DoxyCompactList}\small\item\em Decrypt an SATP packet. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} \mbox{\hyperlink{satp_8h_a0c056dd561cc1e3d59136fbf934dac12}{satp\+\_\+encrypt\+\_\+packet}} (\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}message, size\+\_\+t msglen, \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packetout)
\begin{DoxyCompactList}\small\item\em Encrypt a message into an SATP packet. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a1c4bab130e2a50f12a332e78c31dba37}{satp\+\_\+deserialize\+\_\+device\+\_\+key}} (\mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}} \texorpdfstring{$\ast$}{*}dkey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input)
\begin{DoxyCompactList}\small\item\em Deserialize a client device key. This function deserializes a byte array into a SATP device key structure. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a48d598ef3325f5fbe95a3ed88a017088}{satp\+\_\+serialize\+\_\+device\+\_\+key}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}output, const \mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}} \texorpdfstring{$\ast$}{*}dkey)
\begin{DoxyCompactList}\small\item\em Serialize a client device key. This function serializes a SATP device key structure into a byte array. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{satp_8h_aee061dfbc12a598fb47393ee37288be5}{satp\+\_\+error\+\_\+to\+\_\+string}} (\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} error)
\begin{DoxyCompactList}\small\item\em Return a string description of an SATP error code. This function returns a human-\/readable string corresponding to the provided SATP error code. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{satp_8h_aaa2e0f35cac6e54840a8796077096bc0}{satp\+\_\+extract\+\_\+device\+\_\+key}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}dk, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}sk, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}kid)
\begin{DoxyCompactList}\small\item\em Extract a device key. This function extracts a device key by hashing the server key and key identity. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a3a799bd9ea26e386e6fead4a6b43ca64}{satp\+\_\+packet\+\_\+error\+\_\+message}} (\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} error)
\begin{DoxyCompactList}\small\item\em Populate a packet structure with an error message. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_ab1c0af0699f00c99b2922c5a0de00ccf}{satp\+\_\+deserialize\+\_\+master\+\_\+key}} (\mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}mkey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input)
\begin{DoxyCompactList}\small\item\em Deserialize a master key from a byte array. This function deserializes a byte array into a SATP master key structure. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_ae99fd2e7baae45f495dc6233320362cf}{satp\+\_\+serialize\+\_\+master\+\_\+key}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}output, const \mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}mkey)
\begin{DoxyCompactList}\small\item\em Serialize a master key into a byte array. This function serializes a SATP master key structure into a byte array. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a7998cf2a551b7c4fcf6fbdfcf9ba6ec9}{satp\+\_\+deserialize\+\_\+server\+\_\+key}} (\mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}skey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}input)
\begin{DoxyCompactList}\small\item\em Deserialize a server key from a byte array. This function deserializes a byte array into a SATP server key structure. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a47a1c8f31535ac24db7aa5aa6baf9817}{satp\+\_\+serialize\+\_\+server\+\_\+key}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}output, const \mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}skey)
\begin{DoxyCompactList}\small\item\em Serialize a server key into a byte array. This function serializes a SATP server key structure into a byte array. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a0cc1070b8e5286a63d637aa24bf1850c}{satp\+\_\+increment\+\_\+device\+\_\+key}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}sdkey)
\begin{DoxyCompactList}\small\item\em Increment the serialized key This function clears a key at the current position and increments the kid counter. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{satp_8h_a281a41da487bc334fab7819ee9c02945}{satp\+\_\+generate\+\_\+master\+\_\+key}} (\mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}mkey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}mid)
\begin{DoxyCompactList}\small\item\em Generate a master key-\/set. This function generates a new SATP master key-\/set. It populates the provided master key structure with a randomly generated master derivation key and the key identity, and sets the expiration time. The master key serves as the root from which branch keys are derived. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{satp_8h_a59c530e1cf72b42b6f52771d9afecb15}{satp\+\_\+generate\+\_\+server\+\_\+key}} (\mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}skey, const \mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}mkey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}sid)
\begin{DoxyCompactList}\small\item\em Generate a server key-\/set. This function generates a new SATP server key-\/set based on the provided master key. It populates the server key structure with a derived server key and sets the key identity and expiration time. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a77c0d2627e573b0ab6392e020f2827fc}{satp\+\_\+generate\+\_\+device\+\_\+key}} (\mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}} \texorpdfstring{$\ast$}{*}dkey, const \mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}skey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}did)
\begin{DoxyCompactList}\small\item\em Generate a device key-\/set. This function generates a new SATP device key-\/set using the provided server key. It derives the device key from the server key and sets the key identity and expiration time. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a1f46c173b5fb7d35837a70403572a407}{satp\+\_\+packet\+\_\+clear}} (\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet)
\begin{DoxyCompactList}\small\item\em Clear a SATP network packet. This function resets the fields of a SATP network packet to zero, effectively clearing its state. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_acf0a09fd626ef1c139b89f0c1f3ba025}{satp\+\_\+packet\+\_\+header\+\_\+create}} (\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packetout, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}} flag, uint64\+\_\+t sequence, uint32\+\_\+t msglen)
\begin{DoxyCompactList}\small\item\em Populate a packet header and set the creation time. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a9e349323de91e572ec561f0178e65c80}{satp\+\_\+packet\+\_\+header\+\_\+deserialize}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}header, \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet)
\begin{DoxyCompactList}\small\item\em Deserialize a byte array into a SATP packet header. This function converts a serialized byte array representing a SATP packet header into a structured SATP network packet. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a4a2e702a3fc5f396d04d3e6154a99e7b}{satp\+\_\+packet\+\_\+header\+\_\+serialize}} (const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet, uint8\+\_\+t \texorpdfstring{$\ast$}{*}header)
\begin{DoxyCompactList}\small\item\em Serialize a SATP packet header into a byte array. This function converts a structured SATP network packet header into a serialized byte array for transmission. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} \mbox{\hyperlink{satp_8h_a0b08296d5bd696384523cdf09a228b6b}{satp\+\_\+packet\+\_\+header\+\_\+validate}} (const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packetin, \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}} pktflag, uint64\+\_\+t sequence, uint32\+\_\+t msglen)
\begin{DoxyCompactList}\small\item\em Validate a packet header and timestamp. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_affba3463edb0696a2478b3c488292cae}{satp\+\_\+packet\+\_\+set\+\_\+utc\+\_\+time}} (\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet)
\begin{DoxyCompactList}\small\item\em Set the local UTC seconds time in a SATP packet header. This function updates the SATP packet header with the current UTC time (in seconds). \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API bool \mbox{\hyperlink{satp_8h_a2d7472a57310d89dea3fe523071cf3cc}{satp\+\_\+packet\+\_\+time\+\_\+valid}} (const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet)
\begin{DoxyCompactList}\small\item\em Check if a SATP packet is received within the valid time threshold. This function compares the UTC time in the SATP packet header against the local time to verify that the packet was received within the allowed time threshold. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API size\+\_\+t \mbox{\hyperlink{satp_8h_a397497c605ec6309d2bf676596037f40}{satp\+\_\+packet\+\_\+to\+\_\+stream}} (const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet, uint8\+\_\+t \texorpdfstring{$\ast$}{*}pstream)
\begin{DoxyCompactList}\small\item\em Serialize a SATP packet into a byte array. This function converts a SATP network packet into a contiguous byte stream suitable for network transmission. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a1bd090965292a0a9e373b26751a9bbe2}{satp\+\_\+send\+\_\+network\+\_\+error}} (const qsc\+\_\+socket \texorpdfstring{$\ast$}{*}sock, \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} error)
\begin{DoxyCompactList}\small\item\em Send a plaintext SATP network error message Used only during key exchange, the connection close is sent over an encrypted tunnel. \end{DoxyCompactList}\item 
SATP\+\_\+\+EXPORT\+\_\+\+API void \mbox{\hyperlink{satp_8h_a87ff5101cfbe562d11ae3acab708d638}{satp\+\_\+stream\+\_\+to\+\_\+packet}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}pstream, \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}packet)
\begin{DoxyCompactList}\small\item\em Deserialize a byte stream into a SATP network packet. This function converts a contiguous byte stream into a structured SATP network packet. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
SATP support header Common defined parameters and functions of the SATP client and server implementations. 

The SATP settings.

This header defines the configuration parameters, macros, and constants used in the Symmetric Key Distribution Protocol (SATP). SATP is designed to securely distribute symmetric keys between a master, server, device, and session while providing forward secrecy. The protocol employs ephemeral keys for each session, ensuring that even if a device or server key is compromised, past communications remain secure.

SATP is structured into several phases\+:


\begin{DoxyItemize}
\item {\bfseries{Connect Request\+:}} The client sends its identity string, configuration string, and a random session token to the server. The client computes a device session hash from its device ID, configuration, and token.
\item {\bfseries{Connect Response\+:}} The server verifies the client\textquotesingle{}s configuration and key identity, generates its own session token, computes its session hash, and responds with its server ID, configuration string, and token.
\item {\bfseries{Exchange Request\+:}} The client generates a secret random token key, derives encryption and MAC keys using a combination of its device session hash and embedded key, and then encrypts and MACs the secret token before sending it to the server.
\item {\bfseries{Exchange Response\+:}} The server verifies the MAC, decrypts the token, and derives the receive channel cipher key using its embedded key and the client\textquotesingle{}s device session hash.
\item {\bfseries{Establish Request\+:}} The client verifies the server\textquotesingle{}s token hash and, if valid, encrypts its key identity to send to the server.
\item {\bfseries{Establish Response\+:}} The server decrypts and verifies the key identity, then re-\/encrypts and echoes it back.
\item {\bfseries{Establish Verify\+:}} The client decrypts the echoed key identity and verifies it, thereby finalizing the established session.
\end{DoxyItemize}

In addition, this header defines sizes for configuration strings, error messages, expiration fields, packet headers, keepalive messages, and various key and identity fields, ensuring consistency across SATP implementations.

\begin{DoxyNote}{Note}
The SATP settings provided herein are critical for the proper operation and security of the key distribution process. 
\end{DoxyNote}


\label{doc-define-members}
\Hypertarget{satp_8h_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{satp_8h_ab85d8ae0229ca75b7de3d1e3f149efd2}\index{satp.h@{satp.h}!SATP\_PACKET\_TIME\_THRESHOLD@{SATP\_PACKET\_TIME\_THRESHOLD}}
\index{SATP\_PACKET\_TIME\_THRESHOLD@{SATP\_PACKET\_TIME\_THRESHOLD}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{SATP\_PACKET\_TIME\_THRESHOLD}{SATP\_PACKET\_TIME\_THRESHOLD}}
{\footnotesize\ttfamily \label{satp_8h_ab85d8ae0229ca75b7de3d1e3f149efd2} 
\#define SATP\+\_\+\+PACKET\+\_\+\+TIME\+\_\+\+THRESHOLD~60U}



The maximum number of seconds a packet is considered valid. 

On networks with a shared (NTP) time source, this may be set to as low as 1 second. On exterior networks, it should be adjusted (typically between 30 and 100 seconds) to account for clock differences. 

\label{doc-enum-members}
\Hypertarget{satp_8h_doc-enum-members}
\doxysubsection{Enumeration Type Documentation}
\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}\index{satp.h@{satp.h}!satp\_errors@{satp\_errors}}
\index{satp\_errors@{satp\_errors}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_errors}{satp\_errors}}
{\footnotesize\ttfamily \label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a} 
enum \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}}}



The SATP error values. This enumeration defines the error codes returned by SATP functions. 

\begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_none@{satp\_error\_none}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_none@{satp\_error\_none}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae0bd1ffa173ecefde1602fc4312b82d2}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae0bd1ffa173ecefde1602fc4312b82d2} 
satp\+\_\+error\+\_\+none&No error was detected \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_accept\_fail@{satp\_error\_accept\_fail}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_accept\_fail@{satp\_error\_accept\_fail}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae9ed7692ea5ebb387f5ad7ab551675ec}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae9ed7692ea5ebb387f5ad7ab551675ec} 
satp\+\_\+error\+\_\+accept\+\_\+fail&The socket accept failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_authentication\_failure@{satp\_error\_authentication\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_authentication\_failure@{satp\_error\_authentication\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa201ca1ee4a2d2a7b46ca15ce60c70c73}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa201ca1ee4a2d2a7b46ca15ce60c70c73} 
satp\+\_\+error\+\_\+authentication\+\_\+failure&The authentication failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_authentication\_success@{satp\_error\_authentication\_success}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_authentication\_success@{satp\_error\_authentication\_success}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae319c9039652d5dc7fdeece9e2c0323b}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae319c9039652d5dc7fdeece9e2c0323b} 
satp\+\_\+error\+\_\+authentication\+\_\+success&The authentication succeeded \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_erroe\_listen\_fail@{satp\_erroe\_listen\_fail}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_erroe\_listen\_fail@{satp\_erroe\_listen\_fail}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa298d0eeaed1477349c6e03d5ed535c0d}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa298d0eeaed1477349c6e03d5ed535c0d} 
satp\+\_\+erroe\+\_\+listen\+\_\+fail&The listener socket could not connect \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_allocation\_failure@{satp\_error\_allocation\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_allocation\_failure@{satp\_error\_allocation\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa4b0c8f20e3212dd1a32cfd4c6f5dabb8}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa4b0c8f20e3212dd1a32cfd4c6f5dabb8} 
satp\+\_\+error\+\_\+allocation\+\_\+failure&The memory could not be allocated \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_bad\_keep\_alive@{satp\_error\_bad\_keep\_alive}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_bad\_keep\_alive@{satp\_error\_bad\_keep\_alive}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa5b4dd0b9aac0f5da5a393c67ea3212fd}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa5b4dd0b9aac0f5da5a393c67ea3212fd} 
satp\+\_\+error\+\_\+bad\+\_\+keep\+\_\+alive&The keep alive check failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_cipher\_auth\_failure@{satp\_error\_cipher\_auth\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_cipher\_auth\_failure@{satp\_error\_cipher\_auth\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa9c818a084e31c65dac8a64ecd3561b77}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa9c818a084e31c65dac8a64ecd3561b77} 
satp\+\_\+error\+\_\+cipher\+\_\+auth\+\_\+failure&The cipher authentication has failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_channel\_down@{satp\_error\_channel\_down}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_channel\_down@{satp\_error\_channel\_down}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aac82788262b7d94d77cd96448c2c1046f}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aac82788262b7d94d77cd96448c2c1046f} 
satp\+\_\+error\+\_\+channel\+\_\+down&The communications channel has failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_connection\_failure@{satp\_error\_connection\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_connection\_failure@{satp\_error\_connection\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aab067e0737d6e3ddeb948937fc2f2a20a}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aab067e0737d6e3ddeb948937fc2f2a20a} 
satp\+\_\+error\+\_\+connection\+\_\+failure&The device could not make a connection to the remote host \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_decryption\_failure@{satp\_error\_decryption\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_decryption\_failure@{satp\_error\_decryption\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa6773dd68788a41abaafad2626fc66f36}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa6773dd68788a41abaafad2626fc66f36} 
satp\+\_\+error\+\_\+decryption\+\_\+failure&The decryption authentication has failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_device\_unrecognized@{satp\_error\_device\_unrecognized}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_device\_unrecognized@{satp\_error\_device\_unrecognized}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf54201a835177b6e645071eef3f4690f}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf54201a835177b6e645071eef3f4690f} 
satp\+\_\+error\+\_\+device\+\_\+unrecognized&The device identity is unrecognized \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_establish\_failure@{satp\_error\_establish\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_establish\_failure@{satp\_error\_establish\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa904e1e37972dd8d5b6ef11c822183c16}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa904e1e37972dd8d5b6ef11c822183c16} 
satp\+\_\+error\+\_\+establish\+\_\+failure&The transmission failed at the key exchange establish phase \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_hosts\_exceeded@{satp\_error\_hosts\_exceeded}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_hosts\_exceeded@{satp\_error\_hosts\_exceeded}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa7c1510995d45f8ac5efad74764eb6947}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa7c1510995d45f8ac5efad74764eb6947} 
satp\+\_\+error\+\_\+hosts\+\_\+exceeded&The server has run out of socket connections \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_invalid\_input@{satp\_error\_invalid\_input}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_invalid\_input@{satp\_error\_invalid\_input}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0f36a9a467bca90f55dcf574505315cd}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0f36a9a467bca90f55dcf574505315cd} 
satp\+\_\+error\+\_\+invalid\+\_\+input&The input provided is invalid \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_invalid\_request@{satp\_error\_invalid\_request}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_invalid\_request@{satp\_error\_invalid\_request}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa9de012221558389cfcba4f20471d53fe}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa9de012221558389cfcba4f20471d53fe} 
satp\+\_\+error\+\_\+invalid\+\_\+request&The packet flag was unexpected \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_keep\_alive\_expired@{satp\_error\_keep\_alive\_expired}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_keep\_alive\_expired@{satp\_error\_keep\_alive\_expired}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa8f1b47365c31d684ae30eb80622d3282}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa8f1b47365c31d684ae30eb80622d3282} 
satp\+\_\+error\+\_\+keep\+\_\+alive\+\_\+expired&The keep alive has expired with no response \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_kex\_auth\_failure@{satp\_error\_kex\_auth\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_kex\_auth\_failure@{satp\_error\_kex\_auth\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa2c6e1ff643be3df77b13edcffe9d6f87}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa2c6e1ff643be3df77b13edcffe9d6f87} 
satp\+\_\+error\+\_\+kex\+\_\+auth\+\_\+failure&The key exchange authentication has failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_key\_expired@{satp\_error\_key\_expired}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_key\_expired@{satp\_error\_key\_expired}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa95c284acdbb9926ffa35f11d1b26a809}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa95c284acdbb9926ffa35f11d1b26a809} 
satp\+\_\+error\+\_\+key\+\_\+expired&The SATP public key has expired \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_key\_not\_recognized@{satp\_error\_key\_not\_recognized}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_key\_not\_recognized@{satp\_error\_key\_not\_recognized}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa7c9daf25b67b3467154d82da7c4a184d}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa7c9daf25b67b3467154d82da7c4a184d} 
satp\+\_\+error\+\_\+key\+\_\+not\+\_\+recognized&The key identity is not recognized \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_listener\_fail@{satp\_error\_listener\_fail}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_listener\_fail@{satp\_error\_listener\_fail}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa5b3b79d832d4124935169bf67be1cbf7}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa5b3b79d832d4124935169bf67be1cbf7} 
satp\+\_\+error\+\_\+listener\+\_\+fail&The listener function failed to initialize \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_message\_time\_invalid@{satp\_error\_message\_time\_invalid}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_message\_time\_invalid@{satp\_error\_message\_time\_invalid}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf59560eee974a0abb7ae8bc1a7b7001e}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf59560eee974a0abb7ae8bc1a7b7001e} 
satp\+\_\+error\+\_\+message\+\_\+time\+\_\+invalid&The packet has valid time expired \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_packet\_expired@{satp\_error\_packet\_expired}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_packet\_expired@{satp\_error\_packet\_expired}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa8217e9c14802c70fdf7800a4bd784c12}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa8217e9c14802c70fdf7800a4bd784c12} 
satp\+\_\+error\+\_\+packet\+\_\+expired&The packet keep alive is invalid \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_packet\_unsequenced@{satp\_error\_packet\_unsequenced}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_packet\_unsequenced@{satp\_error\_packet\_unsequenced}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa846f1642f543dd051d40db797f5039db}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa846f1642f543dd051d40db797f5039db} 
satp\+\_\+error\+\_\+packet\+\_\+unsequenced&The packet was received out of sequence \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_random\_failure@{satp\_error\_random\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_random\_failure@{satp\_error\_random\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0d95f0095b9015fcc63c557957a678f6}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0d95f0095b9015fcc63c557957a678f6} 
satp\+\_\+error\+\_\+random\+\_\+failure&The random generator has failed \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_receive\_failure@{satp\_error\_receive\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_receive\_failure@{satp\_error\_receive\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf978ec059e4a360e2d2f3e1e12b79618}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaf978ec059e4a360e2d2f3e1e12b79618} 
satp\+\_\+error\+\_\+receive\+\_\+failure&The receiver failed at the network layer \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_transmit\_failure@{satp\_error\_transmit\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_transmit\_failure@{satp\_error\_transmit\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aac827f214b70ab0a2a415bd6004418da0}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aac827f214b70ab0a2a415bd6004418da0} 
satp\+\_\+error\+\_\+transmit\+\_\+failure&The transmitter failed at the network layer \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_unknown\_protocol@{satp\_error\_unknown\_protocol}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_unknown\_protocol@{satp\_error\_unknown\_protocol}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0a53f61ddd8c8dd1aab552a7e72a746e}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa0a53f61ddd8c8dd1aab552a7e72a746e} 
satp\+\_\+error\+\_\+unknown\+\_\+protocol&The protocol string was not recognized \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_unsequenced@{satp\_error\_unsequenced}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_unsequenced@{satp\_error\_unsequenced}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae4ae8e656692a07a8c36a38ebf16dfac}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aae4ae8e656692a07a8c36a38ebf16dfac} 
satp\+\_\+error\+\_\+unsequenced&The packets sequence number is out of sync \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_verify\_failure@{satp\_error\_verify\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_verify\_failure@{satp\_error\_verify\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaef9010303da834586eb63e71664f6962}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aaef9010303da834586eb63e71664f6962} 
satp\+\_\+error\+\_\+verify\+\_\+failure&The expected data could not be verified \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_error\_general\_failure@{satp\_error\_general\_failure}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_error\_general\_failure@{satp\_error\_general\_failure}}}\Hypertarget{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa3d706ae2143988c8e1cdbf31703589da}\label{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5aa3d706ae2143988c8e1cdbf31703589da} 
satp\+\_\+error\+\_\+general\+\_\+failure&A general failure occurred \\
\hline

\end{DoxyEnumFields}
\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}\index{satp.h@{satp.h}!satp\_flags@{satp\_flags}}
\index{satp\_flags@{satp\_flags}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_flags}{satp\_flags}}
{\footnotesize\ttfamily \label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e} 
enum \mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}}}



The SATP packet flag values. This enumeration defines the flag values used in SATP packets to indicate the type and purpose of the packet. 

\begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_none@{satp\_flag\_none}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_none@{satp\_flag\_none}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea28bca8366091302d8ea83fbcb27c8414}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea28bca8366091302d8ea83fbcb27c8414} 
satp\+\_\+flag\+\_\+none&No flag was selected \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_connect\_request@{satp\_flag\_connect\_request}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_connect\_request@{satp\_flag\_connect\_request}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eac589dc859e24be990d2f883382dbb8ec}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eac589dc859e24be990d2f883382dbb8ec} 
satp\+\_\+flag\+\_\+connect\+\_\+request&The packet contains a connection request \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_connect\_response@{satp\_flag\_connect\_response}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_connect\_response@{satp\_flag\_connect\_response}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea4734a78ed94a982901291eb6da46f093}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea4734a78ed94a982901291eb6da46f093} 
satp\+\_\+flag\+\_\+connect\+\_\+response&The packet contains a connection response \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_connection\_terminate@{satp\_flag\_connection\_terminate}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_connection\_terminate@{satp\_flag\_connection\_terminate}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea28b787cd4b0990423d6287ff7e7e023b}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea28b787cd4b0990423d6287ff7e7e023b} 
satp\+\_\+flag\+\_\+connection\+\_\+terminate&Indicates that the connection is to be terminated \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_encrypted\_message@{satp\_flag\_encrypted\_message}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_encrypted\_message@{satp\_flag\_encrypted\_message}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea8788180430fed49cc83a6f558322194b}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea8788180430fed49cc83a6f558322194b} 
satp\+\_\+flag\+\_\+encrypted\+\_\+message&The packet contains an encrypted message \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_authentication\_request@{satp\_flag\_authentication\_request}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_authentication\_request@{satp\_flag\_authentication\_request}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea5ccea056fdb79fcfaea6e21307348e17}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea5ccea056fdb79fcfaea6e21307348e17} 
satp\+\_\+flag\+\_\+authentication\+\_\+request&The packet contains an authentication request \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_authentication\_response@{satp\_flag\_authentication\_response}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_authentication\_response@{satp\_flag\_authentication\_response}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea54b0410100520e2009f636c639ec2fc5}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea54b0410100520e2009f636c639ec2fc5} 
satp\+\_\+flag\+\_\+authentication\+\_\+response&The packet contains an authentication response \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_auth\_verify@{satp\_flag\_auth\_verify}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_auth\_verify@{satp\_flag\_auth\_verify}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea628018af4907fd9d45a58fea8aba343e}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea628018af4907fd9d45a58fea8aba343e} 
satp\+\_\+flag\+\_\+auth\+\_\+verify&The packet contains an authentication verify message \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_keepalive\_request@{satp\_flag\_keepalive\_request}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_keepalive\_request@{satp\_flag\_keepalive\_request}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eab8fe0aa54700879bac861d7b564522ed}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eab8fe0aa54700879bac861d7b564522ed} 
satp\+\_\+flag\+\_\+keepalive\+\_\+request&The packet is a keep alive request \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_session\_established@{satp\_flag\_session\_established}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_session\_established@{satp\_flag\_session\_established}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eaa741c190841ad6cf4a18d36f38c2a992}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4eaa741c190841ad6cf4a18d36f38c2a992} 
satp\+\_\+flag\+\_\+session\+\_\+established&Indicates that the session has been established \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{satp\_flag\_error\_condition@{satp\_flag\_error\_condition}!satp.h@{satp.h}}\index{satp.h@{satp.h}!satp\_flag\_error\_condition@{satp\_flag\_error\_condition}}}\Hypertarget{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea424f30de28eb65d70844f879e5e3b484}\label{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4ea424f30de28eb65d70844f879e5e3b484} 
satp\+\_\+flag\+\_\+error\+\_\+condition&Indicates that the connection experienced an error \\
\hline

\end{DoxyEnumFields}


\label{doc-func-members}
\Hypertarget{satp_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{satp_8h_a9b7fb21d98c6ca889a0053a2fb8e685c}\index{satp.h@{satp.h}!satp\_connection\_close@{satp\_connection\_close}}
\index{satp\_connection\_close@{satp\_connection\_close}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_connection\_close()}{satp\_connection\_close()}}
{\footnotesize\ttfamily \label{satp_8h_a9b7fb21d98c6ca889a0053a2fb8e685c} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+connection\+\_\+close (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{, }\item[{\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}}}]{err}{, }\item[{bool}]{notify}{}\end{DoxyParamCaption})}



Close the network connection between hosts. 


\begin{DoxyParams}{Parameters}
{\em cns} & A pointer to the connection state structure \\
\hline
{\em err} & The error message \\
\hline
{\em notify} & Notify the remote host connection is closing \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a730dc6b96a4fc8b9880552f02e74e1a6}\index{satp.h@{satp.h}!satp\_connection\_dispose@{satp\_connection\_dispose}}
\index{satp\_connection\_dispose@{satp\_connection\_dispose}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_connection\_dispose()}{satp\_connection\_dispose()}}
{\footnotesize\ttfamily \label{satp_8h_a730dc6b96a4fc8b9880552f02e74e1a6} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+connection\+\_\+dispose (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Reset the connection state. 


\begin{DoxyParams}{Parameters}
{\em cns} & A pointer to the connection state structure \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_aadf6227ad6889be02b6321c23ed822f8}\index{satp.h@{satp.h}!satp\_decrypt\_error\_message@{satp\_decrypt\_error\_message}}
\index{satp\_decrypt\_error\_message@{satp\_decrypt\_error\_message}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_decrypt\_error\_message()}{satp\_decrypt\_error\_message()}}
{\footnotesize\ttfamily \label{satp_8h_aadf6227ad6889be02b6321c23ed822f8} 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} satp\+\_\+decrypt\+\_\+error\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{}\end{DoxyParamCaption})}



Decrypt an error message. 


\begin{DoxyParams}{Parameters}
{\em cns} & A pointer to the SATP client state structure. \\
\hline
{\em message} & The serialized error packet.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} indicating the error message. 
\end{DoxyReturn}
\Hypertarget{satp_8h_a99fbb5fb645a8da4665f1c7b3a8a2075}\index{satp.h@{satp.h}!satp\_decrypt\_packet@{satp\_decrypt\_packet}}
\index{satp\_decrypt\_packet@{satp\_decrypt\_packet}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_decrypt\_packet()}{satp\_decrypt\_packet()}}
{\footnotesize\ttfamily \label{satp_8h_a99fbb5fb645a8da4665f1c7b3a8a2075} 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} satp\+\_\+decrypt\+\_\+packet (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{, }\item[{const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packetin}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t \texorpdfstring{$\ast$}{*}}]{msglen}{}\end{DoxyParamCaption})}



Decrypt an SATP packet. 

This function decrypts the message contained in the input SATP network packet using the client\textquotesingle{}s current decryption state, and copies the plaintext into the provided output buffer. The length of the decrypted message is returned via the msglen parameter.


\begin{DoxyParams}{Parameters}
{\em cns} & A pointer to the SATP client state structure. \\
\hline
{\em packetin} & \mbox{[}const\mbox{]} A pointer to the input SATP network packet. \\
\hline
{\em message} & The output buffer where the decrypted message will be stored. \\
\hline
{\em msglen} & A pointer to a variable that receives the length of the decrypted message.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} indicating the result of the decryption operation. 
\end{DoxyReturn}
\Hypertarget{satp_8h_a1c4bab130e2a50f12a332e78c31dba37}\index{satp.h@{satp.h}!satp\_deserialize\_device\_key@{satp\_deserialize\_device\_key}}
\index{satp\_deserialize\_device\_key@{satp\_deserialize\_device\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_deserialize\_device\_key()}{satp\_deserialize\_device\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a1c4bab130e2a50f12a332e78c31dba37} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+deserialize\+\_\+device\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{dkey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{}\end{DoxyParamCaption})}



Deserialize a client device key. This function deserializes a byte array into a SATP device key structure. 


\begin{DoxyParams}{Parameters}
{\em dkey} & The output SATP device key structure. \\
\hline
{\em input} & The input serialized device key array of size {\ttfamily SATP\+\_\+\+DEVKEY\+\_\+\+ENCODED\+\_\+\+SIZE}. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_ab1c0af0699f00c99b2922c5a0de00ccf}\index{satp.h@{satp.h}!satp\_deserialize\_master\_key@{satp\_deserialize\_master\_key}}
\index{satp\_deserialize\_master\_key@{satp\_deserialize\_master\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_deserialize\_master\_key()}{satp\_deserialize\_master\_key()}}
{\footnotesize\ttfamily \label{satp_8h_ab1c0af0699f00c99b2922c5a0de00ccf} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+deserialize\+\_\+master\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{mkey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{}\end{DoxyParamCaption})}



Deserialize a master key from a byte array. This function deserializes a byte array into a SATP master key structure. 


\begin{DoxyParams}{Parameters}
{\em mkey} & The output SATP master key structure. \\
\hline
{\em input} & The input serialized master key array of size {\ttfamily SATP\+\_\+\+MSTKEY\+\_\+\+ENCODED\+\_\+\+SIZE}. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a7998cf2a551b7c4fcf6fbdfcf9ba6ec9}\index{satp.h@{satp.h}!satp\_deserialize\_server\_key@{satp\_deserialize\_server\_key}}
\index{satp\_deserialize\_server\_key@{satp\_deserialize\_server\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_deserialize\_server\_key()}{satp\_deserialize\_server\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a7998cf2a551b7c4fcf6fbdfcf9ba6ec9} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+deserialize\+\_\+server\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{skey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{input}{}\end{DoxyParamCaption})}



Deserialize a server key from a byte array. This function deserializes a byte array into a SATP server key structure. 


\begin{DoxyParams}{Parameters}
{\em skey} & The output SATP server key structure. \\
\hline
{\em input} & The input serialized server key array of size {\ttfamily SATP\+\_\+\+SRVKEY\+\_\+\+ENCODED\+\_\+\+SIZE}. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a0c056dd561cc1e3d59136fbf934dac12}\index{satp.h@{satp.h}!satp\_encrypt\_packet@{satp\_encrypt\_packet}}
\index{satp\_encrypt\_packet@{satp\_encrypt\_packet}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_encrypt\_packet()}{satp\_encrypt\_packet()}}
{\footnotesize\ttfamily \label{satp_8h_a0c056dd561cc1e3d59136fbf934dac12} 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} satp\+\_\+encrypt\+\_\+packet (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__connection__state}{satp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{message}{, }\item[{size\+\_\+t}]{msglen}{, }\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packetout}{}\end{DoxyParamCaption})}



Encrypt a message into an SATP packet. 

This function encrypts the provided plaintext message using the client\textquotesingle{}s current transmit cipher state. It then constructs an SATP network packet containing the encrypted message along with the appropriate header fields (such as message length, sequence number, and UTC timestamp), and outputs the packet via the provided structure.


\begin{DoxyParams}{Parameters}
{\em cns} & A pointer to the SATP client state structure. \\
\hline
{\em message} & \mbox{[}const\mbox{]} The plaintext message to be encrypted. \\
\hline
{\em msglen} & The length of the plaintext message in bytes. \\
\hline
{\em packetout} & A pointer to the output SATP network packet structure.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} indicating the success or failure of the encryption process. 
\end{DoxyReturn}
\Hypertarget{satp_8h_aee061dfbc12a598fb47393ee37288be5}\index{satp.h@{satp.h}!satp\_error\_to\_string@{satp\_error\_to\_string}}
\index{satp\_error\_to\_string@{satp\_error\_to\_string}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_error\_to\_string()}{satp\_error\_to\_string()}}
{\footnotesize\ttfamily \label{satp_8h_aee061dfbc12a598fb47393ee37288be5} 
SATP\+\_\+\+EXPORT\+\_\+\+API const char \texorpdfstring{$\ast$}{*} satp\+\_\+error\+\_\+to\+\_\+string (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}}}]{error}{}\end{DoxyParamCaption})}



Return a string description of an SATP error code. This function returns a human-\/readable string corresponding to the provided SATP error code. 


\begin{DoxyParams}{Parameters}
{\em error} & The SATP error code.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a pointer to the error description string, or NULL if the error code is not recognized. 
\end{DoxyReturn}
\Hypertarget{satp_8h_aaa2e0f35cac6e54840a8796077096bc0}\index{satp.h@{satp.h}!satp\_extract\_device\_key@{satp\_extract\_device\_key}}
\index{satp\_extract\_device\_key@{satp\_extract\_device\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_extract\_device\_key()}{satp\_extract\_device\_key()}}
{\footnotesize\ttfamily \label{satp_8h_aaa2e0f35cac6e54840a8796077096bc0} 
SATP\+\_\+\+EXPORT\+\_\+\+API bool satp\+\_\+extract\+\_\+device\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{dk}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{sk}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{kid}{}\end{DoxyParamCaption})}



Extract a device key. This function extracts a device key by hashing the server key and key identity. 


\begin{DoxyParams}{Parameters}
{\em dk} & The pointer to the output device key array. \\
\hline
{\em sk} & The input server derivation key. \\
\hline
{\em kid} & The key identity including client id and key counter. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a77c0d2627e573b0ab6392e020f2827fc}\index{satp.h@{satp.h}!satp\_generate\_device\_key@{satp\_generate\_device\_key}}
\index{satp\_generate\_device\_key@{satp\_generate\_device\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_generate\_device\_key()}{satp\_generate\_device\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a77c0d2627e573b0ab6392e020f2827fc} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+generate\+\_\+device\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{dkey}{, }\item[{const \mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{skey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{did}{}\end{DoxyParamCaption})}



Generate a device key-\/set. This function generates a new SATP device key-\/set using the provided server key. It derives the device key from the server key and sets the key identity and expiration time. 


\begin{DoxyParams}{Parameters}
{\em dkey} & A pointer to the SATP device key structure. \\
\hline
{\em skey} & \mbox{[}const\mbox{]} A pointer to the SATP server key structure. \\
\hline
{\em did} & \mbox{[}const\mbox{]} The key identity string. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a281a41da487bc334fab7819ee9c02945}\index{satp.h@{satp.h}!satp\_generate\_master\_key@{satp\_generate\_master\_key}}
\index{satp\_generate\_master\_key@{satp\_generate\_master\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_generate\_master\_key()}{satp\_generate\_master\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a281a41da487bc334fab7819ee9c02945} 
SATP\+\_\+\+EXPORT\+\_\+\+API bool satp\+\_\+generate\+\_\+master\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{mkey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{mid}{}\end{DoxyParamCaption})}



Generate a master key-\/set. This function generates a new SATP master key-\/set. It populates the provided master key structure with a randomly generated master derivation key and the key identity, and sets the expiration time. The master key serves as the root from which branch keys are derived. 


\begin{DoxyParams}{Parameters}
{\em mkey} & A pointer to the SATP master key structure. \\
\hline
{\em mid} & \mbox{[}const\mbox{]} The master key identity.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns false if the random generator fails; otherwise, returns true. 
\end{DoxyReturn}
\Hypertarget{satp_8h_a59c530e1cf72b42b6f52771d9afecb15}\index{satp.h@{satp.h}!satp\_generate\_server\_key@{satp\_generate\_server\_key}}
\index{satp\_generate\_server\_key@{satp\_generate\_server\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_generate\_server\_key()}{satp\_generate\_server\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a59c530e1cf72b42b6f52771d9afecb15} 
SATP\+\_\+\+EXPORT\+\_\+\+API bool satp\+\_\+generate\+\_\+server\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{skey}{, }\item[{const \mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{mkey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{sid}{}\end{DoxyParamCaption})}



Generate a server key-\/set. This function generates a new SATP server key-\/set based on the provided master key. It populates the server key structure with a derived server key and sets the key identity and expiration time. 


\begin{DoxyParams}{Parameters}
{\em skey} & A pointer to the SATP server key structure. \\
\hline
{\em mkey} & \mbox{[}const\mbox{]} A pointer to the SATP master key structure. \\
\hline
{\em sid} & \mbox{[}const\mbox{]} The key identity string.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns false if the random generator fails; otherwise, returns true. 
\end{DoxyReturn}
\Hypertarget{satp_8h_a0cc1070b8e5286a63d637aa24bf1850c}\index{satp.h@{satp.h}!satp\_increment\_device\_key@{satp\_increment\_device\_key}}
\index{satp\_increment\_device\_key@{satp\_increment\_device\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_increment\_device\_key()}{satp\_increment\_device\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a0cc1070b8e5286a63d637aa24bf1850c} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+increment\+\_\+device\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{sdkey}{}\end{DoxyParamCaption})}



Increment the serialized key This function clears a key at the current position and increments the kid counter. 


\begin{DoxyParams}{Parameters}
{\em sdkey} & The input/output serialized SATP server key structure. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a1f46c173b5fb7d35837a70403572a407}\index{satp.h@{satp.h}!satp\_packet\_clear@{satp\_packet\_clear}}
\index{satp\_packet\_clear@{satp\_packet\_clear}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_clear()}{satp\_packet\_clear()}}
{\footnotesize\ttfamily \label{satp_8h_a1f46c173b5fb7d35837a70403572a407} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+packet\+\_\+clear (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{}\end{DoxyParamCaption})}



Clear a SATP network packet. This function resets the fields of a SATP network packet to zero, effectively clearing its state. 


\begin{DoxyParams}{Parameters}
{\em packet} & A pointer to the SATP network packet to clear. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a3a799bd9ea26e386e6fead4a6b43ca64}\index{satp.h@{satp.h}!satp\_packet\_error\_message@{satp\_packet\_error\_message}}
\index{satp\_packet\_error\_message@{satp\_packet\_error\_message}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_error\_message()}{satp\_packet\_error\_message()}}
{\footnotesize\ttfamily \label{satp_8h_a3a799bd9ea26e386e6fead4a6b43ca64} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+packet\+\_\+error\+\_\+message (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{, }\item[{\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}}}]{error}{}\end{DoxyParamCaption})}



Populate a packet structure with an error message. 


\begin{DoxyParams}{Parameters}
{\em packet} & A pointer to the packet structure \\
\hline
{\em error} & The error type \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_acf0a09fd626ef1c139b89f0c1f3ba025}\index{satp.h@{satp.h}!satp\_packet\_header\_create@{satp\_packet\_header\_create}}
\index{satp\_packet\_header\_create@{satp\_packet\_header\_create}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_header\_create()}{satp\_packet\_header\_create()}}
{\footnotesize\ttfamily \label{satp_8h_acf0a09fd626ef1c139b89f0c1f3ba025} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+packet\+\_\+header\+\_\+create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packetout}{, }\item[{\mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}}}]{flag}{, }\item[{uint64\+\_\+t}]{sequence}{, }\item[{uint32\+\_\+t}]{msglen}{}\end{DoxyParamCaption})}



Populate a packet header and set the creation time. 


\begin{DoxyParams}{Parameters}
{\em packetout} & A pointer to the output packet structure \\
\hline
{\em flag} & The packet flag \\
\hline
{\em sequence} & The packet sequence number \\
\hline
{\em msglen} & The length of the message array \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a9e349323de91e572ec561f0178e65c80}\index{satp.h@{satp.h}!satp\_packet\_header\_deserialize@{satp\_packet\_header\_deserialize}}
\index{satp\_packet\_header\_deserialize@{satp\_packet\_header\_deserialize}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_header\_deserialize()}{satp\_packet\_header\_deserialize()}}
{\footnotesize\ttfamily \label{satp_8h_a9e349323de91e572ec561f0178e65c80} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+packet\+\_\+header\+\_\+deserialize (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{header}{, }\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{}\end{DoxyParamCaption})}



Deserialize a byte array into a SATP packet header. This function converts a serialized byte array representing a SATP packet header into a structured SATP network packet. 


\begin{DoxyParams}{Parameters}
{\em header} & A pointer to the input header byte array. \\
\hline
{\em packet} & A pointer to the SATP network packet structure to populate. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a4a2e702a3fc5f396d04d3e6154a99e7b}\index{satp.h@{satp.h}!satp\_packet\_header\_serialize@{satp\_packet\_header\_serialize}}
\index{satp\_packet\_header\_serialize@{satp\_packet\_header\_serialize}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_header\_serialize()}{satp\_packet\_header\_serialize()}}
{\footnotesize\ttfamily \label{satp_8h_a4a2e702a3fc5f396d04d3e6154a99e7b} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+packet\+\_\+header\+\_\+serialize (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{header}{}\end{DoxyParamCaption})}



Serialize a SATP packet header into a byte array. This function converts a structured SATP network packet header into a serialized byte array for transmission. 


\begin{DoxyParams}{Parameters}
{\em packet} & A pointer to the SATP network packet structure to serialize. \\
\hline
{\em header} & The output header byte array. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a0b08296d5bd696384523cdf09a228b6b}\index{satp.h@{satp.h}!satp\_packet\_header\_validate@{satp\_packet\_header\_validate}}
\index{satp\_packet\_header\_validate@{satp\_packet\_header\_validate}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_header\_validate()}{satp\_packet\_header\_validate()}}
{\footnotesize\ttfamily \label{satp_8h_a0b08296d5bd696384523cdf09a228b6b} 
SATP\+\_\+\+EXPORT\+\_\+\+API \mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}} satp\+\_\+packet\+\_\+header\+\_\+validate (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packetin}{, }\item[{\mbox{\hyperlink{satp_8h_ad066a34f2d7493aac88b3d386f0bbd4e}{satp\+\_\+flags}}}]{pktflag}{, }\item[{uint64\+\_\+t}]{sequence}{, }\item[{uint32\+\_\+t}]{msglen}{}\end{DoxyParamCaption})}



Validate a packet header and timestamp. 


\begin{DoxyParams}{Parameters}
{\em packetin} & A pointer to the input packet structure \\
\hline
{\em pktflag} & The packet flag \\
\hline
{\em sequence} & The packet sequence number \\
\hline
{\em msglen} & The length of the message array\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: Returns the function error state 
\end{DoxyReturn}
\Hypertarget{satp_8h_affba3463edb0696a2478b3c488292cae}\index{satp.h@{satp.h}!satp\_packet\_set\_utc\_time@{satp\_packet\_set\_utc\_time}}
\index{satp\_packet\_set\_utc\_time@{satp\_packet\_set\_utc\_time}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_set\_utc\_time()}{satp\_packet\_set\_utc\_time()}}
{\footnotesize\ttfamily \label{satp_8h_affba3463edb0696a2478b3c488292cae} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+packet\+\_\+set\+\_\+utc\+\_\+time (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{}\end{DoxyParamCaption})}



Set the local UTC seconds time in a SATP packet header. This function updates the SATP packet header with the current UTC time (in seconds). 


\begin{DoxyParams}{Parameters}
{\em packet} & A pointer to the SATP network packet structure. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a2d7472a57310d89dea3fe523071cf3cc}\index{satp.h@{satp.h}!satp\_packet\_time\_valid@{satp\_packet\_time\_valid}}
\index{satp\_packet\_time\_valid@{satp\_packet\_time\_valid}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_time\_valid()}{satp\_packet\_time\_valid()}}
{\footnotesize\ttfamily \label{satp_8h_a2d7472a57310d89dea3fe523071cf3cc} 
SATP\+\_\+\+EXPORT\+\_\+\+API bool satp\+\_\+packet\+\_\+time\+\_\+valid (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{}\end{DoxyParamCaption})}



Check if a SATP packet is received within the valid time threshold. This function compares the UTC time in the SATP packet header against the local time to verify that the packet was received within the allowed time threshold. 


\begin{DoxyParams}{Parameters}
{\em packet} & A pointer to the SATP network packet structure.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true if the packet was received within the valid time threshold; otherwise, returns false. 
\end{DoxyReturn}
\Hypertarget{satp_8h_a397497c605ec6309d2bf676596037f40}\index{satp.h@{satp.h}!satp\_packet\_to\_stream@{satp\_packet\_to\_stream}}
\index{satp\_packet\_to\_stream@{satp\_packet\_to\_stream}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_packet\_to\_stream()}{satp\_packet\_to\_stream()}}
{\footnotesize\ttfamily \label{satp_8h_a397497c605ec6309d2bf676596037f40} 
SATP\+\_\+\+EXPORT\+\_\+\+API size\+\_\+t satp\+\_\+packet\+\_\+to\+\_\+stream (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{, }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{pstream}{}\end{DoxyParamCaption})}



Serialize a SATP packet into a byte array. This function converts a SATP network packet into a contiguous byte stream suitable for network transmission. 


\begin{DoxyParams}{Parameters}
{\em packet} & A pointer to the SATP network packet structure. \\
\hline
{\em pstream} & The output byte stream buffer.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the size (in bytes) of the serialized packet. 
\end{DoxyReturn}
\Hypertarget{satp_8h_a1bd090965292a0a9e373b26751a9bbe2}\index{satp.h@{satp.h}!satp\_send\_network\_error@{satp\_send\_network\_error}}
\index{satp\_send\_network\_error@{satp\_send\_network\_error}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_send\_network\_error()}{satp\_send\_network\_error()}}
{\footnotesize\ttfamily \label{satp_8h_a1bd090965292a0a9e373b26751a9bbe2} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+send\+\_\+network\+\_\+error (\begin{DoxyParamCaption}\item[{const qsc\+\_\+socket \texorpdfstring{$\ast$}{*}}]{sock}{, }\item[{\mbox{\hyperlink{satp_8h_ad018e7d955cb389223bcc7e5d8a38c5a}{satp\+\_\+errors}}}]{error}{}\end{DoxyParamCaption})}



Send a plaintext SATP network error message Used only during key exchange, the connection close is sent over an encrypted tunnel. 


\begin{DoxyParams}{Parameters}
{\em sock} & A pointer to the SATP network packet structure. \\
\hline
{\em error} & The output byte stream buffer. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a48d598ef3325f5fbe95a3ed88a017088}\index{satp.h@{satp.h}!satp\_serialize\_device\_key@{satp\_serialize\_device\_key}}
\index{satp\_serialize\_device\_key@{satp\_serialize\_device\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_serialize\_device\_key()}{satp\_serialize\_device\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a48d598ef3325f5fbe95a3ed88a017088} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+serialize\+\_\+device\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{, }\item[{const \mbox{\hyperlink{structsatp__device__key}{satp\+\_\+device\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{dkey}{}\end{DoxyParamCaption})}



Serialize a client device key. This function serializes a SATP device key structure into a byte array. 


\begin{DoxyParams}{Parameters}
{\em output} & The output byte array to hold the serialized device key. \\
\hline
{\em dkey} & The input SATP device key structure. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_ae99fd2e7baae45f495dc6233320362cf}\index{satp.h@{satp.h}!satp\_serialize\_master\_key@{satp\_serialize\_master\_key}}
\index{satp\_serialize\_master\_key@{satp\_serialize\_master\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_serialize\_master\_key()}{satp\_serialize\_master\_key()}}
{\footnotesize\ttfamily \label{satp_8h_ae99fd2e7baae45f495dc6233320362cf} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+serialize\+\_\+master\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{, }\item[{const \mbox{\hyperlink{structsatp__master__key}{satp\+\_\+master\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{mkey}{}\end{DoxyParamCaption})}



Serialize a master key into a byte array. This function serializes a SATP master key structure into a byte array. 


\begin{DoxyParams}{Parameters}
{\em output} & The output byte array to hold the serialized master key. \\
\hline
{\em mkey} & The input SATP master key structure. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a47a1c8f31535ac24db7aa5aa6baf9817}\index{satp.h@{satp.h}!satp\_serialize\_server\_key@{satp\_serialize\_server\_key}}
\index{satp\_serialize\_server\_key@{satp\_serialize\_server\_key}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_serialize\_server\_key()}{satp\_serialize\_server\_key()}}
{\footnotesize\ttfamily \label{satp_8h_a47a1c8f31535ac24db7aa5aa6baf9817} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+serialize\+\_\+server\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{output}{, }\item[{const \mbox{\hyperlink{structsatp__server__key}{satp\+\_\+server\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{skey}{}\end{DoxyParamCaption})}



Serialize a server key into a byte array. This function serializes a SATP server key structure into a byte array. 


\begin{DoxyParams}{Parameters}
{\em output} & The output byte array to hold the serialized server key. \\
\hline
{\em skey} & The input SATP server key structure. \\
\hline
\end{DoxyParams}
\Hypertarget{satp_8h_a87ff5101cfbe562d11ae3acab708d638}\index{satp.h@{satp.h}!satp\_stream\_to\_packet@{satp\_stream\_to\_packet}}
\index{satp\_stream\_to\_packet@{satp\_stream\_to\_packet}!satp.h@{satp.h}}
\doxysubsubsection{\texorpdfstring{satp\_stream\_to\_packet()}{satp\_stream\_to\_packet()}}
{\footnotesize\ttfamily \label{satp_8h_a87ff5101cfbe562d11ae3acab708d638} 
SATP\+\_\+\+EXPORT\+\_\+\+API void satp\+\_\+stream\+\_\+to\+\_\+packet (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{pstream}{, }\item[{\mbox{\hyperlink{structsatp__network__packet}{satp\+\_\+network\+\_\+packet}} \texorpdfstring{$\ast$}{*}}]{packet}{}\end{DoxyParamCaption})}



Deserialize a byte stream into a SATP network packet. This function converts a contiguous byte stream into a structured SATP network packet. 


\begin{DoxyParams}{Parameters}
{\em pstream} & A pointer to the input byte stream. \\
\hline
{\em packet} & A pointer to the SATP network packet structure to populate. \\
\hline
\end{DoxyParams}
